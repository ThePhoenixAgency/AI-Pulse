<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Inconsistent location triggering?</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.55; color: #e2e8f0; max-width: 800px; margin: 26px auto; padding: 0 18px; background: #0a0e27; }
  h1 { color: #00d9ff; margin-bottom: 0.35em; line-height: 1.22; font-size: clamp(1.45rem, 2.1vw, 1.95rem); font-weight: 700; }
  .metadata { color: #94a3b8; font-size: 0.86em; margin-bottom: 1.2em; border-bottom: 1px solid rgba(0,217,255,0.2); padding-bottom: 0.7em; }
  p { margin-bottom: 0.72em; line-height: 1.58; }
  img { max-width: 100%; width: auto !important; height: auto !important; object-fit: contain !important; border-radius: 8px; display: block; margin: 0.6em auto; }
  a { color: #00d9ff; }
  .article-elevator { position: fixed; right: 14px; bottom: 14px; display: flex; flex-direction: column; gap: 8px; z-index: 9999; }
  .article-elevator-btn { width: 36px; height: 36px; border: 1px solid rgba(0,217,255,0.35); border-radius: 10px; background: rgba(10,14,39,0.88); color: #00d9ff; cursor: pointer; font-size: 16px; line-height: 1; }
  .article-elevator-btn:hover { background: rgba(10,14,39,1); }
  [id*="overlay"], [class*="overlay"], [id*="modal"], [class*="modal"], [id*="popup"], [class*="popup"],
  [id*="paywall"], [class*="paywall"], [id*="subscribe"], [class*="subscribe"], [id*="cookie"], [class*="cookie"],
  [id*="consent"], [class*="consent"], [id*="gdpr"], [class*="gdpr"], [role="dialog"], [aria-modal="true"] {
    display: none !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }
</style>
</head>
<body>
  <h1>Inconsistent location triggering?</h1>
  <div class="metadata">
    Source: Home Assistant Community Forum (Latest) | Date: 2/28/2026 11:44:23 AM | <a href="https://community.home-assistant.io/t/inconsistent-location-triggering/991405" target="_blank" rel="noopener noreferrer">Lien</a> | Lang: EN
  </div>
  <div class="content">
    <p><p>I have an automation to open a garage door automatically as I drive towards my house. It worked for a while and then stopped working. I used the device_tracked as the trigger. I use the same automation for my wife, and for her it never triggered.</p>
<p>I have checked and re-checked all the phone companion app permissions and sensors (including making sure the app is not a put to sleep) and - as you will see below - this is unlikely to be the issue.</p>
<p>The issue is the trigger. It never fires. I have tried this approach:</p>
<pre><code class="lang-auto"> - trigger: zone entity_id: device_tracker.sm_s938b zone: zone.home event: enter
</code></pre>
<p>This worked for a while and the stopped working.</p>
<p>So I have also tried this approach:</p>
<pre><code class="lang-auto"> - trigger: state entity_id: person.john_smith to: home
</code></pre>
<p>And out of an excess of frustration I have even tried the either-or approach:</p>
<pre><code class="lang-auto">triggers: - trigger: zone entity_id: device_tracker.sm_s938b zone: zone.home event: enter - trigger: state entity_id: person.john_smith to: home
</code></pre>
<p>Now, here is the twist. To debug this I created a few separate automations to just send me a notification to my phone. And both of these triggers fire appropriately and reliably on that automation. So for some reason the EXACT same trigger fires on one automation but not another. Can anyone help me debug this?</p>
<p>I include the code of the entire malfunctioning automation below, as I suspect perhaps something else (like the complicated jinja stuff at the bottom?) might be interfering with the processing of the triggers. I can just not imagine how or why. The jinja template at the bottom analyses the leftmost 17 characters of every bluetooth connection (ie the MAC) to determine which vehicle I am driving and hence which garage door should open.</p>
<p>Here goes:</p>
<pre data-code-wrap="yaml"><code class="lang-yaml">alias: Open correct garage door description: Open correct garage door for approaching vehicle
triggers: - trigger: zone entity_id: device_tracker.sm_s938b zone: zone.home event: enter - trigger: state entity_id: person.john_smith to: home
conditions: - alias: check whether garage door is closed condition: template value_template: &gt; {{ is_state('binary_sensor.omnilink_garage_dr_'~ garage_door_num, 'off') }} - alias: In which case no vehicle is connected condition: template value_template: "{{ garage_door_num != 0 }}"
actions: - action: light.turn_on metadata: {} target: entity_id: light.omnilink_garagedr_{{ garage_door_num }} data: {}
variables: garage_door_num: &gt; {# #1 Jeep, #2 VW, #3 Audi, 0 = none #} {% set connected = state_attr('sensor.sm_s938b_bluetooth_connection', 'connected_paired_devices') | default([]) %} {% set macs = connected | map('regex_search', '^.{17}') | map('upper') | list %} {% if 'F8:6D:CC:A7:ED:2D' in macs %} 1 {% elif '9C:8D:7C:32:6F:52' in macs %} 2 {% elif '00:0E:9F:73:06:72' in macs %} 3 {% else %} 0 {% endif %}
mode: single
</code></pre>
<p>I’m a bit at my wit’s end here. Like I said, the exact same triggers fire if I use them in simpler automations. But in this case, the automation does not trigger at all.</p> <p><small>6 posts - 2 participants</small></p> <p><a href="https://community.home-assistant.io/t/inconsistent-location-triggering/991405">Read full topic</a></p></p>
  </div>
  <div class="article-elevator" aria-label="Navigation article">
    <button class="article-elevator-btn" type="button" onclick="history.back()" title="Retour">←</button>
    <button class="article-elevator-btn" type="button" onclick="scrollToTop()">▲</button>
    <button class="article-elevator-btn" type="button" onclick="scrollToBottom()">▼</button>
  </div>
  <script>
    function stripBlockingPanels() {
      const selector = '[id*="overlay"], [class*="overlay"], [id*="modal"], [class*="modal"], [id*="popup"], [class*="popup"], [id*="paywall"], [class*="paywall"], [id*="subscribe"], [class*="subscribe"], [id*="cookie"], [class*="cookie"], [id*="consent"], [class*="consent"], [id*="gdpr"], [class*="gdpr"], [role="dialog"], [aria-modal="true"]';
      const textPattern = /\b(cookie|consent|gdpr|subscribe|subscription|paywall|abonnez[-\s]?vous|inscrivez[-\s]?vous|continue reading|continuez la lecture|connexion|login|register|inscription|abonnement|premium|subscriber|compte|account|se connecter|sign in|sign up)\b/i;
      document.querySelectorAll(selector).forEach((node) => node.remove());
      document.querySelectorAll('div, section, aside, header, footer, nav').forEach((node) => {
        const styleAttr = String(node.getAttribute('style') || '').toLowerCase();
        const classAndId = String(node.className || '').toLowerCase() + ' ' + String(node.id || '').toLowerCase();
        const text = String(node.textContent || '').slice(0, 1200);
        const hasKeyword = textPattern.test(classAndId) || textPattern.test(text);
        const looksFixed = /(position\s*:\s*(fixed|sticky)|inset\s*:|top\s*:|left\s*:|right\s*:|bottom\s*:)/.test(styleAttr);
        const hasPriority = /(z-index\s*:\s*[1-9]\d{1,}|backdrop-filter|overflow\s*:\s*hidden)/.test(styleAttr);
        if (hasKeyword && (looksFixed || hasPriority)) node.remove();
      });
    }
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'auto' });
    }
    function scrollToBottom() {
      window.scrollTo({ top: document.documentElement.scrollHeight, behavior: 'auto' });
    }
    window.addEventListener('message', (event) => {
      const data = event && event.data;
      if (!data || data.type !== 'AI_PULSE_SCROLL') return;
      if (data.direction === 'up' || data.direction === 'top') scrollToTop();
      if (data.direction === 'down' || data.direction === 'bottom') scrollToBottom();
    });
    stripBlockingPanels();
    setTimeout(stripBlockingPanels, 60);
    setTimeout(stripBlockingPanels, 220);
    setTimeout(stripBlockingPanels, 650);
  </script>
</body>
</html>