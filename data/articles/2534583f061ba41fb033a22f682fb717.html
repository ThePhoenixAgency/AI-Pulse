<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Microsoft Discloses DNS-Based ClickFix Attack Using Nslookup for Malware Staging</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.8; color: #e2e8f0; max-width: 800px; margin: 40px auto; padding: 0 20px; background: #0a0e27; }
  h1 { color: #00d9ff; margin-bottom: 0.5em; }
  .metadata { color: #94a3b8; font-size: 0.9em; margin-bottom: 2em; border-bottom: 1px solid rgba(0,217,255,0.2); padding-bottom: 1em; }
  img { max-width: 100%; height: auto; border-radius: 8px; }
  a { color: #00d9ff; }
  p { margin-bottom: 1em; }
  blockquote { border-left: 3px solid #825ee4; padding-left: 15px; color: #94a3b8; }
  code { background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 3px; color: #ff79c6; }
  pre { background: rgba(0,0,0,0.4); padding: 15px; border-radius: 6px; overflow-x: auto; }

  .article-elevator { position: fixed; right: 14px; bottom: 14px; display: flex; flex-direction: column; gap: 8px; z-index: 9999; }
  .article-elevator-btn { width: 36px; height: 36px; border: 1px solid rgba(0,217,255,0.35); border-radius: 10px; background: rgba(10,14,39,0.88); color: #00d9ff; cursor: pointer; font-size: 16px; line-height: 1; }
  .article-elevator-btn:hover { background: rgba(10,14,39,1); }

</style>
</head>
<body>
  <h1>Microsoft Discloses DNS-Based ClickFix Attack Using Nslookup for Malware Staging</h1>
  <div class="metadata">
    Source: The Hacker News | Date: 2/15/2026 | Lang: EN |
    <a href="https://thehackernews.com/2026/02/microsoft-discloses-dns-based-clickfix.html" target="_blank">Original Article</a>
  </div>
  <div class="content">
    <div><div><p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgTITWEvp6Fk_BovXCLk1PaSAb0HJBzETmOcgn9ZPlY81ojfvKU3aoqM3BO_mtyqpL1idL2F1TY7e_3dAJiW6_DMDUAK5Q-zGKUnQvP1POiFDB_M0HwKiMQK2DuIihygT7Hpar1KtZ5KYCDISM2E98kRCBNxxt27oBWDX2hS0Qres6xc_0wFdaNbrxp92fj/s1600/dns.jpg"><img alt="" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgTITWEvp6Fk_BovXCLk1PaSAb0HJBzETmOcgn9ZPlY81ojfvKU3aoqM3BO_mtyqpL1idL2F1TY7e_3dAJiW6_DMDUAK5Q-zGKUnQvP1POiFDB_M0HwKiMQK2DuIihygT7Hpar1KtZ5KYCDISM2E98kRCBNxxt27oBWDX2hS0Qres6xc_0wFdaNbrxp92fj/s1600/dns.jpg" /></a></p>
<p>Microsoft has <a href="https://x.com/MsftSecIntel/status/2022456612120629742" target="_blank">disclosed</a> details of a new version of the ClickFix social engineering tactic in which the attackers trick unsuspecting users into running commands that carry out a Domain Name System (DNS) lookup to retrieve the next-stage payload.</p>
<p>Specifically, the attack relies on using the "<a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/nslookup" target="_blank">nslookup</a>" (short for <a href="https://www.linode.com/docs/guides/how-to-use-nslookup-command/" target="_blank">nameserver lookup</a>) command to execute a custom DNS lookup triggered via the Windows Run dialog.</p>
<p>ClickFix is an <a href="https://thehackernews.com/2026/01/clickfix-attacks-expand-using-fake.html" target="_blank">increasingly popular technique</a> that's traditionally delivered via phishing, malvertising, or drive-by download schemes, often redirecting targets to bogus landing pages that host fake CAPTCHA verification or instructions to address a non-existent problem on their computers by running a command either through the Windows Run dialog or the macOS Terminal app.</p>
<p>The attack method has become widespread over the past two years since it hinges on the victims infecting their own machines with malware, thereby allowing the threat actors to bypass security controls. The effectiveness of ClickFix has been such that it has <a href="https://thehackernews.com/2026/01/crashfix-chrome-extension-delivers.html" target="_blank">spawned</a> several <a href="https://thehackernews.com/2025/12/weekly-recap-apple-0-days-winrar.html#:~:text=ConsentFix%2C%20a%20New%20Twist%20on%20ClickFix" target="_blank">variants</a>, such as FileFix, JackFix, ConsentFix, CrashFix, and GlitchFix.</p>
<p>"In the latest DNS-based staging using ClickFix, the initial command runs through cmd.exe and performs a DNS lookup against a hard-coded external DNS server, rather than the system's default resolver," the Microsoft Threat Intelligence team said in a series of posts on X. "The output is filtered to extract the `Name:` DNS response, which is executed as the second-stage payload."</p>

<p>Microsoft said this new variation of ClickFix uses DNS as a "lightweight staging or signaling channel," enabling the threat actor to reach infrastructure under their control, as well as erect a new validation layer before executing the second-stage payload.</p>
<p>"Using DNS in this way reduces dependency on traditional web requests and can help blend malicious activity into normal network traffic," the Windows maker added.</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKrVRv1TWmP09yr7qOg4XZVnR8Mf4Lgfy91YuAuwHaulxm_4LKezdhCqFtacRDAEvhL0wbfwhN1y_KU4gRlKFqHZ_JogmZ1b_M4SeqKG7U1KYKfGucNqsiS-3FRrXbrhBcbA1PnxnrXpveweTGZ-KvjgDmxgORoHgkZ9RiQo3AROqgloYMNzScZIXZ70yX/s1600/ms.jpg"><img alt="" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjKrVRv1TWmP09yr7qOg4XZVnR8Mf4Lgfy91YuAuwHaulxm_4LKezdhCqFtacRDAEvhL0wbfwhN1y_KU4gRlKFqHZ_JogmZ1b_M4SeqKG7U1KYKfGucNqsiS-3FRrXbrhBcbA1PnxnrXpveweTGZ-KvjgDmxgORoHgkZ9RiQo3AROqgloYMNzScZIXZ70yX/s1600/ms.jpg" /></a></p>
<p>The downloaded payload subsequently initiates an attack chain that leads to the download of a ZIP archive from an external server ("azwsappdev[.]com"), from which a malicious Python script is extracted and run to conduct reconnaissance, run discovery commands, and drop a Visual Basic Script (VBScript) responsible for launching ModeloRAT, a Python-based remote access trojan <a href="https://thehackernews.com/2026/01/crashfix-chrome-extension-delivers.html" target="_blank">previously distributed</a> through CrashFix.</p>
<p>To establish persistence, a Windows shortcut (LNK) file pointing to the VBScript is created in the Windows Startup folder so that the malware is automatically launched every time the operating system is started. </p>
<p>The disclosure comes as Bitdefender warned of a surge in <a href="https://thehackernews.com/2025/10/threatsday-bulletin-176m-crypto-fine.html#lumma-stealer-stumbles-after-doxxing-drama" target="_blank">Lumma Stealer</a> activity, driven by ClickFix-style fake CAPTCHA campaigns that deploy an AutoIt-version of <a href="https://thehackernews.com/2025/12/four-threat-clusters-using-castleloader.html" target="_blank">CastleLoader</a>, a malware loader associated with a threat actor codenamed GrayBravo (formerly TAG-150).</p>
<p>CastleLoader incorporates checks to determine the presence of virtualization software and specific security programs before decrypting and launching the stealer malware in memory. Outside of ClickFix, websites advertising cracked software and pirated movies serve as bait for CastleLoader-based attack chains, deceiving users into downloading rogue installers or executables masquerading as MP4 media files.</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj055fK8SiBCP1N6jVBRJvdzvxdHhtWVNN4ehUllrQY7gNnejbwJxmPO6m29jEtDkayu-L4lqC4IBYhbsxSBrI5XAfYOC2vJQXbl3BixNTcJpkCadFvK0GS87jfig_YUIpUSUdsETkaralJ_iWPBF1_vkVC-QRKnfuo5L_3uh-VFCBzE2TYFDn22_XVVbqD/s1600/bit-flow.jpg"><img alt="" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj055fK8SiBCP1N6jVBRJvdzvxdHhtWVNN4ehUllrQY7gNnejbwJxmPO6m29jEtDkayu-L4lqC4IBYhbsxSBrI5XAfYOC2vJQXbl3BixNTcJpkCadFvK0GS87jfig_YUIpUSUdsETkaralJ_iWPBF1_vkVC-QRKnfuo5L_3uh-VFCBzE2TYFDn22_XVVbqD/s1600/bit-flow.jpg" /></a></p>
<p>Other CastleLoader campaigns have also leveraged websites promising cracked software downloads as a starting point to distribute a fake NSIS installer that also runs obfuscated VBA scripts prior to running the AutoIt script that loads Lumma Stealer. The VBA loader is designed to run scheduled tasks responsible for ensuring persistence.</p>
<p>"Despite significant <a href="https://thehackernews.com/2025/05/fbi-and-europol-disrupt-lumma-stealer.html" target="_blank">law enforcement disruption efforts</a> in 2025, Lumma Stealer operations continued, demonstrating resilience by rapidly migrating to new hosting providers and adapting alternative loaders and delivery techniques," the Romanian cybersecurity company <a href="https://www.bitdefender.com/en-us/blog/labs/lummastealer-second-life-castleloader" target="_blank">said</a>. "At the core of many of these campaigns is CastleLoader, which plays a central role in helping LummaStealer spread through delivery chains."</p>
<p>Interestingly, one of the domains on CastleLoader's infrastructure ("testdomain123123[.]shop") was flagged as a Lumma Stealer command-and-control (C2), indicating that the operators of the two malware families are either working together or sharing service providers. The majority of Lumma Stealer infections have been recorded in India, followed by France, the U.S., Spain, Germany, Brazil, Mexico, Romania, Italy, and Canada.</p>
<p>"The effectiveness of ClickFix lies in its abuse of procedural trust rather than technical vulnerabilities," Bitdefender said. "The instructions resemble troubleshooting steps or verification workarounds that users may have encountered previously. As a result, victims often fail to recognize that they are manually executing arbitrary code on their own system."</p>

<p>CastleLoader is not the only loader that's being used to distribute Lumma Stealer. Campaigns observed as early as March 2025 have leveraged another loader dubbed <a href="https://thehackernews.com/2026/02/threatsday-bulletin-ai-prompt-rce.html#new-loaders-fuel-stealer-campaigns" target="_blank">RenEngine Loader</a>, with the malware propagated under the guise of game cheats and pirated software like CorelDRAW graphics editor. In these attacks, the loader makes way for a secondary loader named Hijack Loader, which then deploys Lumma Stealer.</p>
<p>According to <a href="https://securelist.com/renengine-campaign-with-hijackloader-lumma-and-acr-stealer/118891/" target="_blank">data</a> from Kaspersky, RenEngine Loader attacks have primarily affected users in Russia, Brazil, Turkey, Spain, Germany, Mexico, Algeria, Egypt, Italy, and France since March 2025.</p>
<p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgCiVEm5gVA7bwnq4hM8Urn1JxIqVkUsMJTlC73mfziu_OEAX7wdv5VkN63dSSZp5sDS1hvySyHWWnhmT8a7GtkNxAT9ybNlHlxm4YfCRmBoLJDYFQroG3-UosVbI3qBxqinfngjbFpJj3OgHDWmHjgIMc6LqW-pNUD0i8FFt6dxkMTV16nWf3EJVh9kpIP/s1600/games.png"><img alt="" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgCiVEm5gVA7bwnq4hM8Urn1JxIqVkUsMJTlC73mfziu_OEAX7wdv5VkN63dSSZp5sDS1hvySyHWWnhmT8a7GtkNxAT9ybNlHlxm4YfCRmBoLJDYFQroG3-UosVbI3qBxqinfngjbFpJj3OgHDWmHjgIMc6LqW-pNUD0i8FFt6dxkMTV16nWf3EJVh9kpIP/s1600/games.png" /></a></p>
<p>The developments coincide with the emergence of various campaigns using social engineering lures, including ClickFix, to deliver a variety of stealers and malware loaders -</p>
<ul>
<li>A macOS campaign that has used phishing and malvertising ploys to deliver Odyssey Stealer, a rebrand of Poseidon Stealer, which itself is a fork of Atomic macOS Stealer (<a href="https://thehackernews.com/2025/06/new-atomic-macos-stealer-campaign.html" target="_blank">AMOS</a>). The stealer exfiltrates credentials and data from 203 browser wallet extensions and 18 desktop wallet applications to facilitate cryptocurrency theft.</li>
<li>"Beyond credential theft, Odyssey operates as a full remote access trojan," Censys <a href="https://censys.com/blog/odyssey-stealer-macos-crypto-stealing-operation" target="_blank">said</a>. "A persistent LaunchDaemon polls the C2 every 60 seconds for commands, supporting arbitrary shell execution, reinfection, and a SOCKS5 proxy for tunneling traffic through victim machines."</li>
<li>A <a href="https://www.levelblue.com/blogs/spiderlabs-blog/how-clickfix-opens-the-door-to-stealthy-stealc-information-stealer" target="_blank">ClickFix attack chain</a> targeting Windows systems that uses fake CAPTCHA verification pages on legitimate-but-compromised websites to trick users into executing PowerShell commands that deploy the <a href="https://thehackernews.com/2026/01/security-bug-in-stealc-malware-panel.html" target="_blank">StealC</a> information stealer.</li>
<li>An <a href="https://www.levelblue.com/blogs/spiderlabs-blog/stealerium-unmasked-inside-a-multi-lure-multi-stage-stealer-campaign" target="_blank">email phishing campaign</a> that uses a malicious SVG file contained within a password‑protected ZIP archive to instruct the victim to run a PowerShell command using ClickFix, ultimately resulting in the deployment of an open-source .NET infostealer called <a href="https://thehackernews.com/2023/02/enigma-vector-and-tgtoxic-new-threats.html" target="_blank">Stealerium</a>.</li>
<li>A campaign that <a href="https://thehackernews.com/2026/02/google-reports-state-backed-hackers.html" target="_blank">exploits the public sharing feature</a> of generative artificial intelligence (AI) services like Anthropic Claude to stage malicious ClickFix instructions on how to perform a variety of tasks on macOS (e.g., "online DNS resolver"), and distribute these links via sponsored results on search engines like Google to deploy Atomic Stealer and <a href="https://thehackernews.com/2025/12/new-macsync-macos-stealer-uses-signed.html" target="_blank">MacSync Stealer</a>.</li>
<li>A campaign that directs users searching for "macOS cli disk space analyzer" to a fake Medium article impersonating Apple's Support Team to deceive them into running ClickFix instructions that deliver next-stage stealer payloads from an external server "raxelpak[.]com."</li>
<li>"The C2 domain raxelpak[.]com has URL history going back to 2021, when it appeared to host a safety workwear e-commerce site," MacPaw's Moonlock Lab <a href="https://x.com/moonlock_lab/status/2021695650367226108" target="_blank">said</a>. "Whether the domain was hijacked or simply expired and re-registered by the [threat actor] is unclear, but it fits the broader pattern of leveraging aged domains with existing reputation to avoid detection."</li>
<li>A variation of the same campaign that stages ClickFix instructions for supposedly installing Homebrew on links associated with Claude and Evernote and distributes them through sponsored results to install stealer malware.</li>
<li>"The ad shows a real, recognized domain (claude.ai), not a spoof or typo-squatted site," AdGuard <a href="https://adguard.com/en/blog/claude-google-ads-malware-poisoning-macos.html" target="_blank">said</a>. "Clicking the ad leads to a real Claude page, not a phishing copy. The consequence is clear: Google Ads + a well-known trusted platform + technical users with high downstream impact = a potent malware distribution vector."</li>
<li>A macOS email phishing campaign that prompts recipients to download and run an AppleScript file to address supposed compatibility issues, resulting in the deployment of another AppleScript designed to steal credentials and retrieve additional JavaScript payloads.</li>
<li>"The malware does not grant permissions to itself; instead, it forges TCC authorizations for trusted Apple-signed binaries (Terminal, osascript, Script Editor, and bash) and then executes malicious actions through these binaries to inherit their permissions," Darktrace <a href="https://www.darktrace.com/blog/applescript-abuse-unpacking-a-macos-phishing-campaign" target="_blank">said</a>.</li>
<li>A <a href="https://thehackernews.com/2025/03/clearfake-infects-9300-sites-uses-fake.html" target="_blank">ClearFake campaign</a> that employs <a href="https://www.darktrace.com/blog/clearfake-from-fake-captchas-to-blockchain-driven-payload-retrieval" target="_blank">fake CAPTCHA lures</a> on compromised WordPress sites to trigger the execution of an HTML Application (HTA) file and deploy Lumma Stealer. The campaign is also known to use malicious JavaScript injections to take advantage of a technique known as EtherHiding to execute a contract hosted on the BNB Smart Chain and fetch an unknown payload hosted on GitHub.</li>
<li>EtherHiding offers attackers several advantages. It allows malicious traffic to blend with legitimate Web3 activity. Because blockchain is immutable and decentralized, it also offers increased resilience in the face of takedown efforts.</li>
</ul>
<p>The use of ClickFix techniques to target macOS underlines a broader trend where threat actors are increasingly seeking out machines that run Apple's operating system to infect them with infostealers and sophisticated tools, per a recent analysis published by Flare. No less than 103 Chrome crypto extensions are targeted by macOS stealers, with attackers obtaining valid Apple developer signatures to bypass <a href="https://thehackernews.com/2025/02/new-frigidstealer-malware-targets-macos.html">Gatekeeper protections</a>.</p>
<p>"Nearly every macOS stealer prioritizes cryptocurrency theft above all else," the company <a href="https://flare.io/learn/resources/blog/the-macos-stealer-gold-rush-how-cybercriminals-are-racing-to-exploit-apples-ecosystem" target="_blank">said</a>. "This laser focus reflects economic reality. Cryptocurrency users disproportionately use Macs. They often hold significant value in software wallets. Unlike bank accounts, crypto transactions are irreversible. Once seed phrases are compromised, funds disappear permanently with no recourse."</p>
<p>"The 'Macs don't get viruses' assumption is not just outdated but actively dangerous. Organizations with Mac users need detection capabilities for macOS-specific TTPs: unsigned applications requesting passwords, unusual Terminal activity, connections to blockchain nodes for non-financial purposes, and data exfiltration patterns targeting Keychain and browser storage."</p>

<p>Found this article interesting?  Follow us on <a href="https://news.google.com/publications/CAAqLQgKIidDQklTRndnTWFoTUtFWFJvWldoaFkydGxjbTVsZDNNdVkyOXRLQUFQAQ" target="_blank">Google News</a>, <a href="https://twitter.com/thehackersnews" target="_blank">Twitter</a> and <a href="https://www.linkedin.com/company/thehackernews/" target="_blank">LinkedIn</a> to read more exclusive content we post.</p>
</div></div>
  </div>
</body>
</html>