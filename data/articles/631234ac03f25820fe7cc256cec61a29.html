<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Raspberry Pi 5 : piloter des LEDs WS2812B de maniÃ¨re fiable avec le bus SPI</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.8; color: #e2e8f0; max-width: 800px; margin: 40px auto; padding: 0 20px; background: #0a0e27; }
  h1 { color: #00d9ff; margin-bottom: 0.5em; }
  .metadata { color: #94a3b8; font-size: 0.9em; margin-bottom: 2em; border-bottom: 1px solid rgba(0,217,255,0.2); padding-bottom: 1em; }
  img { max-width: 100%; height: auto; border-radius: 8px; }
  a { color: #00d9ff; }
  p { margin-bottom: 1em; }
  blockquote { border-left: 3px solid #825ee4; padding-left: 15px; color: #94a3b8; }
  code { background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 3px; color: #ff79c6; }
  pre { background: rgba(0,0,0,0.4); padding: 15px; border-radius: 6px; overflow-x: auto; }
</style>
</head>
<body>
  <h1>Raspberry Pi 5 : piloter des LEDs WS2812B de maniÃ¨re fiable avec le bus SPI</h1>
  <div class="metadata">
    Source: Framboise 314 | Date: 12/13/2025 | Lang: FR |
    <a href="https://www.framboise314.fr/raspberry-pi-5-ws2812b-spi/" target="_blank">Original Article</a>
  </div>
  <div class="content">
    <div><div>
			<p>La question du pilotage des LEDs <strong>WS2812B</strong> sur <strong>Raspberry Pi 5</strong> a rÃ©cemment Ã©tÃ© soulevÃ©e par Victor lors dâ€™un Ã©change sur un rÃ©seau social. Le Raspberry Pi 5 introduit une nouvelle architecture matÃ©rielle qui complique le pilotage des LEDs WS2812B avec les bibliothÃ¨ques historiques. Les solutions basÃ©es sur le PWM ou le DMA montrent rapidement leurs limites en termes de fiabilitÃ©. Cet article prÃ©sente une mÃ©thode robuste utilisant le bus SPI du Raspberry Pi 5 pour piloter des LEDs adressables WS2812B, avec un fonctionnement stable, reproductible et adaptÃ© aux projets makers et applications pÃ©dagogiques.</p>

<div><p>Au sommaire :</p><ul><li><a href="#Raspberry_Pi_5_piloter_des_LEDs_WS2812B_de_maniere_fiable_avec_le_bus_SPI"><span>1</span> Raspberry Pi 5 : piloter des LEDs WS2812B de maniÃ¨re fiable avec le bus SPI</a><ul><li><a href="#Introduction"><span>1.1</span> Introduction</a></li><li><a href="#Pourquoi_les_WS2812B_posent_probleme_sur_Raspberry_Pi_5"><span>1.2</span> Pourquoi les WS2812B posent problÃ¨me sur Raspberry Pi 5</a><ul><li><a href="#Rappel_rapide_sur_le_fonctionnement_des_WS2812B"><span>1.2.1</span> Rappel rapide sur le fonctionnement des WS2812B</a></li><li><a href="#Ce_qui_change_avec_le_Raspberry_Pi_5"><span>1.2.2</span> Ce qui change avec le Raspberry Pi 5</a></li><li><a href="#Limites_des_bibliotheques_historiques_PWM_DMA_rpi_ws281x"><span>1.2.3</span> Limites des bibliothÃ¨ques historiques (PWM, DMA, rpi_ws281x)</a></li></ul></li><li><a href="#Pourquoi_utiliser_le_bus_SPI_pour_piloter_des_WS2812B_sur_Raspberry_Pi_5"><span>1.3</span> Pourquoi utiliser le bus SPI pour piloter des WS2812B sur Raspberry Pi 5</a></li><li><a href="#La_bibliotheque_retenue_rpi5-ws2812_niklasr22"><span>1.4</span> La bibliothÃ¨que retenue : rpi5-ws2812 (niklasr22)</a><ul><li><a href="#Comment_ca_fonctionne_tres_rapidement"><span>1.4.1</span> Comment Ã§a fonctionne (trÃ¨s rapidement)</a></li><li><a href="#Installation_sans_environnement_virtuel_Bookworm_et_pourquoi"><span>1.4.2</span> Installation sans environnement virtuel (Bookworm) et pourquoi</a></li><li><a href="#Alternative_propre_pour_eviter_lutilisation_de_root"><span>1.4.3</span> Alternative Â«Â propreÂ Â» pour Ã©viter lâ€™utilisation de root</a></li></ul></li><li><a href="#Verifier_la_disponibilite_du_SPI_sur_Raspberry_Pi_5"><span>1.5</span> VÃ©rifier la disponibilitÃ© du SPI sur Raspberry Pi 5</a></li><li><a href="#Connexion_du_ruban_WS2812B_au_Raspberry_Pi_5"><span>1.6</span> Connexion du ruban WS2812B au Raspberry Pi 5</a><ul><li><a href="#A_propos_des_niveaux_logiques"><span>1.6.1</span> Ã€ propos des niveaux logiques</a></li></ul></li><li><a href="#Exemple_1_test_simple_rouge_vert_bleu"><span>1.7</span> Exemple 1 : test simple (rouge / vert / bleu)</a></li><li><a href="#Exemple_2_chenillard_une_LED_allumee_a_la_fois"><span>1.8</span> Exemple 2 : chenillard (une LED allumÃ©e Ã  la fois)</a></li><li><a href="#Video"><span>1.9</span> VidÃ©o</a></li><li><a href="#Conclusion"><span>1.10</span> Conclusion</a></li><li><a href="#Sources"><span>1.11</span> Sources</a></li></ul></li></ul></div>

<h2><span>Introduction</span></h2>
<p>Le pilotage des LEDs adressables WS2812B fait partie des grands classiques des projets makers, et le Raspberry Pi a longtemps Ã©tÃ© une plateforme apprÃ©ciÃ©e pour ce type dâ€™expÃ©rimentations. Avec lâ€™arrivÃ©e du Raspberry Pi 5, les choses se compliquent : la nouvelle architecture matÃ©rielle et logicielle rend les bibliothÃ¨ques historiques basÃ©es sur le PWM ou le DMA peu fiables, voire inutilisables dans certains cas.</p>
<p>Câ€™est suite Ã  une question posÃ©e par Victor lors dâ€™un Ã©change sur un rÃ©seau social que ce sujet a Ã©tÃ© approfondi. Lâ€™objectif Ã©tait double : lâ€™aider Ã  faire fonctionner correctement des WS2812B avec un Raspberry Pi 5, et en profiter pour tester de maniÃ¨re rigoureuse une solution rÃ©ellement exploitable sur cette nouvelle plateforme.</p>
<p>Cet article prÃ©sente donc un retour dâ€™expÃ©rience complet : identification des limites des solutions existantes, choix dâ€™une approche basÃ©e sur le bus SPI, mise en Å“uvre concrÃ¨te, piÃ¨ges rencontrÃ©s et correctifs appliquÃ©s. Lâ€™ensemble des tests a Ã©tÃ© rÃ©alisÃ© sur un Raspberry Pi 5 sous Raspberry Pi OS Bookworm, avec un anneau de WS2812B, afin de proposer une mÃ©thode fiable, reproductible et adaptÃ©e aux projets makers comme aux usages pÃ©dagogiques.</p>
<h2><span><strong>Pourquoi les WS2812B posent problÃ¨me sur Raspberry Pi 5</strong></span></h2>
<h3><span><strong>Rappel rapide sur le fonctionnement des WS2812B</strong></span></h3>
<p><img src="https://www.framboise314.fr/wp-content/uploads/2025/12/Pi5_ws2812b_02.jpg" alt="" /></p>
<p>Les WS2812B sont des LEDs adressables qui intÃ¨grent leur propre contrÃ´leur. Chaque LED reÃ§oit un flux de donnÃ©es sÃ©rie Ã  un timing trÃ¨s strict (environ 800 kHz) et relaie automatiquement les informations destinÃ©es aux LEDs suivantes. Ce fonctionnement impose un respect prÃ©cis des durÃ©es des impulsions logiques, sous peine de provoquer des erreurs dâ€™affichage ou des comportements alÃ©atoires.</p>
<h3><span><strong>Ce qui change avec le Raspberry Pi 5</strong></span></h3>
<p><img src="https://www.framboise314.fr/wp-content/uploads/2025/12/Pi5_ws2812b_03.png" alt="" /></p>
<p>Avec le Raspberry Pi 5, lâ€™architecture matÃ©rielle et la gestion des GPIO ont profondÃ©ment Ã©voluÃ©. Le nouveau SoC et la pile logicielle associÃ©e modifient la maniÃ¨re dont les signaux sont gÃ©nÃ©rÃ©s et planifiÃ©s, rendant plus difficile la production de timings prÃ©cis en sortie GPIO. Des mÃ©thodes qui fonctionnaient correctement sur les gÃ©nÃ©rations prÃ©cÃ©dentes deviennent alors instables ou imprÃ©visibles sur le Pi 5.</p>
<h3><span><strong>Limites des bibliothÃ¨ques historiques (PWM, DMA, rpi_ws281x)</strong></span></h3>
<p><img src="https://www.framboise314.fr/wp-content/uploads/2025/12/Pi5_ws2812b_04.jpg" alt="" /></p>
<p>Les bibliothÃ¨ques historiques utilisÃ©es pour piloter les WS2812B sur Raspberry Pi reposent gÃ©nÃ©ralement sur le PWM ou le DMA pour gÃ©nÃ©rer les signaux nÃ©cessaires. Sur le Raspberry Pi 5, ces approches montrent rapidement leurs limites : scintillements, LEDs fantÃ´mes, pertes de synchronisation ou fonctionnement erratique. La bibliothÃ¨que rpi_ws281x, largement utilisÃ©e jusque-lÃ , nâ€™est notamment plus adaptÃ©e sans modifications profondes, ce qui impose de repenser la mÃ©thode de pilotage des WS2812B sur cette nouvelle plateforme.</p>
<h2><span><strong>Pourquoi utiliser le bus SPI pour piloter des WS2812B sur Raspberry Pi 5</strong></span></h2>
<p>Le bus SPI du Raspberry Pi 5 constitue une alternative fiable pour piloter des LEDs <strong>WS2812B</strong>, car il repose sur un <a href="https://github.com/raspberrypi/documentation/blob/master/documentation/asciidoc/computers/raspberry-pi/spi-bus-on-raspberry-pi.adoc?utm_source=chatgpt.com" target="_blank"><strong>contrÃ´leur matÃ©riel dÃ©diÃ©</strong></a>, indÃ©pendant du systÃ¨me multitÃ¢che et du scheduler Linux. Contrairement aux sorties GPIO pilotÃ©es par PWM ou DMA, le SPI garantit une horloge stable et un flux de donnÃ©es continu, deux Ã©lÃ©ments essentiels pour respecter le timing strict imposÃ© par les WS2812B.</p>
<p>En utilisant le SPI, les donnÃ©es destinÃ©es aux LEDs sont encodÃ©es sous forme de motifs binaires compatibles avec le protocole des WS2812B, puis envoyÃ©es de maniÃ¨re dÃ©terministe via le matÃ©riel. Cette approche devrait Ã©viter les interruptions et les variations de timing responsables des scintillements ou des LEDs fantÃ´mes observÃ©s avec les bibliothÃ¨ques historiques sur Raspberry Pi 5. (jâ€™ai quand mÃªme notÃ© quelques Â«Â <em>pÃ©touilles</em>Â«Â )</p>
<p>Enfin, le SPI Ã©tant pleinement supportÃ© par la nouvelle architecture du Pi 5, cette solution sâ€™avÃ¨re stable, reproductible et parfaitement adaptÃ©e aux projets makers et pÃ©dagogiques nÃ©cessitant un pilotage fiable des LEDs adressables.</p>
<div>
<p>âœ” Lorsque vous voyez <code>/dev/spidev0.0</code> ou <code>/dev/spidev0.1</code>, il ne sâ€™agit pas dâ€™une Ã©mulation logicielle, mais bien de lâ€™accÃ¨s Ã  un <strong>contrÃ´leur SPI matÃ©riel intÃ©grÃ© directement dans la puce</strong> du Raspberry Pi.</p>
<p>âœ” Linux sâ€™appuie sur un <strong>driver SPI du noyau</strong>, basÃ© sur ce contrÃ´leur matÃ©riel, qui gÃ©nÃ¨re le signal SPI de maniÃ¨re dÃ©terministe, indÃ©pendamment du scheduler Linux ou de la charge CPU (au moins pour lâ€™Ã©mission et la rÃ©ception des octets).</p>
<p>ğŸ“ RÃ©fÃ©rence : documentation officielle Raspberry Pi â€“ SPI bus<br />
<a href="https://github.com/raspberrypi/documentation/blob/master/documentation/asciidoc/computers/raspberry-pi/spi-bus-on-raspberry-pi.adoc" target="_blank"><br />
GitHub â€“ raspberrypi/documentation<br />
</a></p>
</div>
<h2><span>La bibliothÃ¨que retenue : rpi5-ws2812 (niklasr22)</span></h2>
<p>La bibliothÃ¨que <strong>rpi5-ws2812</strong> a Ã©tÃ© Ã©crite spÃ©cifiquement pour le <strong>Raspberry PiÂ 5</strong>, car la rÃ©fÃ©rence historiqueÂ <code>rpi_ws281x</code> nâ€™est pas encore compatible avec cette nouvelle plateforme. Un point important : cette bibliothÃ¨que ne pilote les WS2812B <strong>quâ€™en utilisant le bus SPI</strong>.</p>
<p>ğŸ“ DÃ©pÃ´t GitHub :Â <a href="https://github.com/niklasr22/rpi5-ws2812" target="_blank">https://github.com/niklasr22/rpi5-ws2812<br />
</a></p>
<h3></h3>
<p>Les LEDs WS2812B imposent un signal extrÃªmement sensible au timing, ce qui rend leur pilotage dÃ©licat sur un systÃ¨me multitÃ¢che comme Linux. Avec <strong>rpi5-ws2812</strong>, les couleurs (au format <strong>GRB</strong>) sont encodÃ©es en une trame binaire compatible WS2812, puis envoyÃ©es via le<br />
<strong>contrÃ´leur SPI matÃ©riel</strong> du Raspberry Pi.<br />
CÃ´tÃ© cÃ¢blage, la ligne <strong>DIN</strong> des WS2812B est reliÃ©e Ã  la broche <strong>MOSI</strong> du Raspberry Pi (GPIO10, broche 19), ce qui correspond au pÃ©riphÃ©rique <code>/dev/spidev0.0</code> lorsque lâ€™on utilise SPI0 avec le<br />
chip-select CE0.</p>
<p>Lâ€™API est volontairement simpleÂ :</p>
<ul>
<li><code>WS2812SpiDriver(...).get_strip()</code></li>
<li><code>set_all_pixels()</code></li>
<li><code>set_pixel_color()</code></li>
<li><code>show()</code></li>
</ul>
<h3><span>Installation sans environnement virtuel (Bookworm) et pourquoi</span></h3>
<p>Sous Raspberry Pi OS Bookworm (basÃ© sur Debian), <code>pip</code> est bridÃ© par le mÃ©canisme <strong>PEPÂ 668</strong> (<em>externally managed environment</em>). Lâ€™objectif est dâ€™inciter Ã  utiliser des environnements virtuels (<code>venv</code>) afin dâ€™Ã©viter toute interfÃ©rence avec les paquets Python du systÃ¨me.</p>
<p>Cependant, lorsquâ€™on souhaite piloter le SPI en lanÃ§ant le script en tant que <strong>root</strong> (<code>sudo python3 ...</code>), un problÃ¨me classique apparaÃ®t : si la bibliothÃ¨que est installÃ©e uniquement pour lâ€™utilisateur (dans<code>~/.local</code>), <strong>root ne la voit pas</strong>, ce qui provoque une erreur <code>Â ModuleNotFoundError</code>.</p>
<p>Sans utiliser de <code>venv</code>, la mÃ©thode la plus directe consiste donc Ã  installer la bibliothÃ¨que Ã©galement pour root, en contournant explicitement la protection PEPÂ 668Â :</p>




		<div>
				<table>
					<tbody><tr>
				<td>
					<div><p>1</p></div>
				</td>
						<td><div><p><span>sudo </span><span>pip3 </span><span>install</span><span> </span><span>--</span><span>break</span><span>-</span><span>system</span><span>-</span><span>packages </span><span>rpi5</span><span>-</span><span>ws2812</span></p></div></td>
					</tr>
				</tbody></table>
			</div>


<p>Ce contournement est prÃ©vu par la PEP 668 : on force lâ€™installation dans le Python systÃ¨me en acceptant un risque thÃ©orique de conflit, ce qui reste acceptable dans le cadre dâ€™un projet maker dÃ©diÃ©. ğŸ“ RÃ©fÃ©rence PEP 668 :Â <a href="https://peps.python.org/pep-0668/" target="_blank">https://peps.python.org/pep-0668/<br />
</a></p>
<h3><span>Alternative Â«Â propreÂ Â» pour Ã©viter lâ€™utilisation de root</span></h3>
<p>La documentation de <strong>rpi5-ws2812</strong> indique quâ€™il est possible dâ€™Ã©viter <code>sudo</code> en autorisant lâ€™utilisateur Ã  accÃ©der au bus SPI.</p>
<p>En pratique, cela consiste Ã Â :</p>
<ul>
<li>activer le SPI via <code>raspi-config</code>,</li>
<li>vÃ©rifier que lâ€™utilisateur a accÃ¨s Ã  <code>/dev/spidev0.0</code>,</li>
<li>et lancer le script Python sans privilÃ¨ges root.</li>
</ul>
<h2><span>VÃ©rifier la disponibilitÃ© du SPI sur Raspberry Pi 5</span></h2>
<p>Avant toute chose, il est indispensable de vÃ©rifier que le bus SPI est bien activÃ© et accessible sur le Raspberry Pi 5.</p>
<p>Le SPI peut Ãªtre activÃ© de deux maniÃ¨res :</p>
<ul>
<li>en ligne de commande avec <code>sudo raspi-config</code> â†’ Interface Options â†’ SPI â†’ Enable</li>
<li>ou en mode graphique via <strong>PrÃ©fÃ©rences â†’ Configuration â†’ Interfaces â†’ SPI</strong></li>
</ul>
<p>Une fois le SPI activÃ©, la commande suivante permet de vÃ©rifier les pÃ©riphÃ©riques disponibles :</p>



		<div>
				<table>
					<tbody><tr>
				<td>
					<div><p>1</p></div>
				</td>
						<td><div><p><span>ls</span><span> </span><span>/</span><span>dev</span><span>/</span><span>spidev*</span></p></div></td>
					</tr>
				</tbody></table>
			</div>

<p>Sur un Raspberry Pi 5 fonctionnel, on obtient typiquement :</p>



		<div>
				<table>
					<tbody><tr>
				<td>
					<div><p>1</p><p>2</p><p>3</p></div>
				</td>
						<td><div><p><span>/</span><span>dev</span><span>/</span><span>spidev0</span><span>.</span><span>0</span></p><p><span>/</span><span>dev</span><span>/</span><span>spidev0</span><span>.</span><span>1</span></p><p><span>/</span><span>dev</span><span>/</span><span>spidev10</span><span>.</span><span>0</span></p></div></td>
					</tr>
				</tbody></table>
			</div>


<p>Le pilotage des WS2812B sâ€™effectue via <strong>SPI0 / CE0</strong>, soitÂ <code>/dev/spidev0.0</code>. Le pÃ©riphÃ©rique <code>spidev10.0</code> peut apparaÃ®tre sur le Pi 5, mais il nâ€™est pas utilisable dans ce contexte.</p>
<h2><span>Connexion du ruban WS2812B au Raspberry Pi 5</span></h2>
<div><p><a href="https://www.framboise314.fr/wp-content/uploads/2025/12/Pi5_ws2812b_06-scaled.jpg" target="_blank"><img src="https://www.framboise314.fr/wp-content/uploads/2025/12/Pi5_ws2812b_06-scaled.jpg" alt="" /></a></p><p>Cliquez pour agrandir</p></div>
<p>Le pilotage des LEDs WS2812B via le bus SPI nÃ©cessite un cÃ¢blage simple mais rigoureux. Une attention particuliÃ¨re doit Ãªtre portÃ©e Ã  lâ€™alimentation et au respect des niveaux logiques.</p>
<ul>
<li><strong>DIN (Data In) du ruban WS2812B</strong> â†’ <strong>MOSI du Raspberry Pi 5 </strong>(GPIO10, brocheÂ 19)</li>
<li><strong>GND du ruban WS2812B</strong> â†’ <strong>GND du Raspberry Pi </strong>(par exemple brocheÂ 6)</li>
<li><strong>+5Â V du ruban WS2812B</strong> â†’ <strong>alimentation 5 V stable </strong>(brocheÂ 2 du Raspberry Pi ou alimentation externe dÃ©diÃ©e)</li>
</ul>
<p>âš ï¸ Les WS2812B fonctionnent exclusivement en <strong>5Â V</strong>. Il ne faut en aucun cas les alimenter en 3,3Â V. La masse (<strong>GND</strong>) du ruban doit impÃ©rativement Ãªtre commune avec elle du Raspberry Pi.<br />
Dans cette configuration, le bus utilisÃ© est <strong>SPI0 / CE0</strong>, ce qui correspond au pÃ©riphÃ©rique <code>/dev/spidev0.0</code>.</p>
<h3><span>Ã€ propos des niveaux logiques</span></h3>
<p>Le Raspberry Pi 5 dÃ©livre un signal logique en <strong>3,3Â V</strong> sur sa broche MOSI, alors que les WS2812B attendent idÃ©alement un signal proche de <strong>5Â V</strong>.<br />
Dans de nombreux cas, notamment avec des rubans courts ou des anneaux, le signal 3,3 V fonctionne correctement. Pour une fiabilitÃ© maximale, en particulier avec des longueurs importantes, lâ€™utilisation dâ€™un <strong>convertisseur de niveau logique 3,3 V â†’ 5 V </strong>(74AHCT125, 74HCT245, etc.) est recommandÃ©e.</p>
<p>Une fois le cÃ¢blage rÃ©alisÃ© et le SPI activÃ©, le ruban WS2812B est prÃªt Ã  Ãªtre pilotÃ© via laÂ  bibliothÃ¨que <strong>rpi5-ws2812</strong>.</p>
<h2><span>Exemple 1 : test simple (rouge / vert / bleu)</span></h2>
<p>Ce premier programme permet de valider rapidement lâ€™ensemble de la chaÃ®ne : SPI, cÃ¢blage et bibliothÃ¨que. Avec un anneau de 16 LEDs, les couleurs rouge, verte et bleue doivent sâ€™afficher successivement.</p>




		<div>
		
			<div><p><span>Python</span></p></div>
			
			
			<div>
				<table>
					<tbody><tr>
				<td>
					<div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p></div>
				</td>
						<td><div><p><span>#!/usr/bin/env python3</span></p><p><span>from</span><span> </span><span>rpi5_ws2812</span><span>.</span><span>ws2812 </span><span>import</span><span> </span><span>Color</span><span>,</span><span> </span><span>WS2812SpiDriver</span></p><p><span>import</span><span> </span><span>time</span></p><p><span># Nombre de LEDs de lâ€™anneau</span></p><p><span>NB_LEDS</span><span> </span><span>=</span><span> </span><span>16</span></p><p><span>def</span><span> </span><span>main</span><span>(</span><span>)</span><span>:</span></p><p><span>Â Â Â Â </span><span># Driver SPI -&gt; MOSI (GPIO10, pin 19)</span></p><p><span>Â Â Â Â </span><span>driver</span><span> </span><span>=</span><span> </span><span>WS2812SpiDriver</span><span>(</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>spi_bus</span><span>=</span><span>0</span><span>,</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>spi_device</span><span>=</span><span>0</span><span>,</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>led_count</span><span>=</span><span>NB</span><span>_</span>LEDS</p><p><span>Â Â Â Â </span><span>)</span></p><p><span>Â Â Â Â </span><span># RÃ©cupÃ©ration du strip + luminositÃ©</span></p><p><span>Â Â Â Â </span><span>strip</span><span> </span><span>=</span><span> </span><span>driver</span><span>.</span><span>get_strip</span><span>(</span><span>)</span></p><p><span>Â Â Â Â </span><span>strip</span><span>.</span><span>brightness</span><span> </span><span>=</span><span> </span><span>0.2</span></p><p><span>Â Â Â Â </span><span>while</span><span> </span><span>True</span><span>:</span></p><p><span>Â Â Â Â Â Â Â Â </span><span># Rouge</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>strip</span><span>.</span><span>set_all_pixels</span><span>(</span><span>Color</span><span>(</span><span>255</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>)</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>strip</span><span>.</span><span>show</span><span>(</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>time</span><span>.</span><span>sleep</span><span>(</span><span>0.5</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span># Vert</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>strip</span><span>.</span><span>set_all_pixels</span><span>(</span><span>Color</span><span>(</span><span>0</span><span>,</span><span> </span><span>255</span><span>,</span><span> </span><span>0</span><span>)</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>strip</span><span>.</span><span>show</span><span>(</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>time</span><span>.</span><span>sleep</span><span>(</span><span>0.5</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span># Bleu</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>strip</span><span>.</span><span>set_all_pixels</span><span>(</span><span>Color</span><span>(</span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>255</span><span>)</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>strip</span><span>.</span><span>show</span><span>(</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>time</span><span>.</span><span>sleep</span><span>(</span><span>0.5</span><span>)</span></p><p><span>if</span><span> </span><span>__name__</span><span> </span><span>==</span><span> </span><span>"__main__"</span><span>:</span></p><p><span>Â Â Â Â </span><span>main</span><span>(</span><span>)</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>


<p>Si les trois couleurs sâ€™enchaÃ®nent correctement, le SPI, le cÃ¢blage et la bibliothÃ¨que sont opÃ©rationnels.</p>
<h2><span>Exemple 2 : chenillard (une LED allumÃ©e Ã  la fois)</span></h2>
<p>Ce second exemple montre lâ€™utilisation de lâ€™API officielle de <strong>rpi5-ws2812</strong> pour piloter individuellement les LEDs, sans accÃ©der aux structures internes de la bibliothÃ¨que.<br />
Une courte trame noire est envoyÃ©e avant chaque mise Ã  jour afin de limiter les effets parasites observÃ©s sur certains anneaux WS2812B.</p>




		<div>
		
			<div><p><span>Python</span></p></div>
			
			
			<div>
				<table>
					<tbody><tr>
				<td>
					<div><p>1</p><p>2</p><p>3</p><p>4</p><p>5</p><p>6</p><p>7</p><p>8</p><p>9</p><p>10</p><p>11</p><p>12</p><p>13</p><p>14</p><p>15</p><p>16</p><p>17</p><p>18</p><p>19</p><p>20</p><p>21</p><p>22</p><p>23</p><p>24</p><p>25</p><p>26</p><p>27</p><p>28</p><p>29</p><p>30</p><p>31</p><p>32</p><p>33</p><p>34</p><p>35</p><p>36</p><p>37</p><p>38</p><p>39</p><p>40</p><p>41</p></div>
				</td>
						<td><div><p><span>#!/usr/bin/env python3</span></p><p><span>from</span><span> </span><span>rpi5_ws2812</span><span>.</span><span>ws2812 </span><span>import</span><span> </span><span>Color</span><span>,</span><span> </span><span>WS2812SpiDriver</span></p><p><span>import</span><span> </span><span>time</span></p><p><span>NB_LEDS</span><span> </span><span>=</span><span> </span><span>16</span></p><p><span>def</span><span> </span><span>send_frame</span><span>(</span><span>strip</span><span>,</span><span> </span><span>colors</span><span>)</span><span>:</span></p><p><span>Â Â Â Â </span><span># Frame noire pour reset interne</span></p><p><span>Â Â Â Â </span><span>strip</span><span>.</span><span>set_all_pixels</span><span>(</span><span>Color</span><span>(</span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>)</span><span>)</span></p><p><span>Â Â Â Â </span><span>strip</span><span>.</span><span>show</span><span>(</span><span>)</span></p><p><span>Â Â Â Â </span><span>time</span><span>.</span><span>sleep</span><span>(</span><span>0.0001</span><span>)</span><span>Â Â </span><span># 100 Âµs</span></p><p><span>Â Â Â Â </span><span># Frame rÃ©elle</span></p><p><span>Â Â Â Â </span><span>for</span><span> </span><span>i</span><span> </span><span>in</span><span> </span><span>range</span><span>(</span><span>NB_LEDS</span><span>)</span><span>:</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>strip</span><span>.</span><span>set_pixel_color</span><span>(</span><span>i</span><span>,</span><span> </span><span>colors</span><span>[</span><span>i</span><span>]</span><span>)</span></p><p><span>Â Â Â Â </span><span>strip</span><span>.</span><span>show</span><span>(</span><span>)</span></p><p><span>def</span><span> </span><span>main</span><span>(</span><span>)</span><span>:</span></p><p><span>Â Â Â Â </span><span>driver</span><span> </span><span>=</span><span> </span><span>WS2812SpiDriver</span><span>(</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>spi_bus</span><span>=</span><span>0</span><span>,</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>spi_device</span><span>=</span><span>0</span><span>,</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>led_count</span><span>=</span><span>NB</span><span>_</span>LEDS</p><p><span>Â Â Â Â </span><span>)</span></p><p><span>Â Â Â Â </span><span>strip</span><span> </span><span>=</span><span> </span><span>driver</span><span>.</span><span>get_strip</span><span>(</span><span>)</span></p><p><span>Â Â Â Â </span><span>strip</span><span>.</span><span>set_brightness</span><span>(</span><span>0.2</span><span>)</span></p><p><span>Â Â Â Â </span><span>position</span><span> </span><span>=</span><span> </span><span>0</span></p><p><span>Â Â Â Â </span><span>while</span><span> </span><span>True</span><span>:</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>colors</span><span> </span><span>=</span><span> </span><span>[</span><span>Color</span><span>(</span><span>0</span><span>,</span><span> </span><span>0</span><span>,</span><span> </span><span>0</span><span>)</span><span>]</span><span> </span><span>*</span><span> </span><span>NB_LEDS</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>colors</span><span>[</span><span>position</span><span>]</span><span> </span><span>=</span><span> </span><span>Color</span><span>(</span><span>0</span><span>,</span><span> </span><span>255</span><span>,</span><span> </span><span>0</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>send_frame</span><span>(</span><span>strip</span><span>,</span><span> </span><span>colors</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span>time</span><span>.</span><span>sleep</span><span>(</span><span>0.05</span><span>)</span></p><p><span>Â Â Â Â Â Â Â Â </span><span># Calcul de position modulo pour un anneau de LEDs </span></p><p><span>Â Â Â Â Â Â Â Â </span><span>position</span><span> </span><span>=</span><span> </span><span>(</span><span>position</span><span> </span><span>+</span><span> </span><span>1</span><span>)</span><span> </span><span>%</span><span> </span><span>NB_LEDS</span></p><p><span>if</span><span> </span><span>__name__</span><span> </span><span>==</span><span> </span><span>"__main__"</span><span>:</span></p><p><span>Â Â Â Â </span><span>main</span><span>(</span><span>)</span></p></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>


<p>Ce chenillard valide le pilotage individuel des LEDs et permet dâ€™observer la stabilitÃ© du signal SPI dans le temps.</p>
<h2><span>VidÃ©o</span></h2>
<p>
<a href="https://www.framboise314.fr/wp-content/uploads/2025/12/ws2812.mp4">https://www.framboise314.fr/wp-content/uploads/2025/12/ws2812.mp4</a></p>

<h2><span>Conclusion</span></h2>
<p>Le pilotage des LEDs <strong>WS2812B</strong> sur <strong>Raspberry Pi 5</strong> nÃ©cessite dâ€™adapter les mÃ©thodes utilisÃ©es jusquâ€™Ã  prÃ©sent, les bibliothÃ¨ques historiques nâ€™Ã©tant plus adaptÃ©es Ã  la nouvelle architecture. Lâ€™utilisation du <strong>bus SPI</strong>, combinÃ©e Ã  une bibliothÃ¨que spÃ©cifiquement conÃ§ue pour le Pi 5 comme <em><strong>rpi5-ws2812</strong></em>, permet dâ€™obtenir une solution fiable et reproductible. Les tests prÃ©sentÃ©s dans cet article montrent quâ€™il est possible de piloter des LEDs adressables sans artifices ni contournements hasardeux, Ã  condition de respecter le cÃ¢blage, la configuration du SPI et les bonnes pratiques logicielles. Merci Ã  Victor pour avoir soulevÃ© cette question, qui a permis dâ€™explorer et de valider une approche efficace sur Raspberry Pi 5.</p>
<h2><span>Sources</span></h2>
<p><a href="https://github.com/niklasr22/rpi5-ws2812" target="_blank">https://github.com/niklasr22/rpi5-ws2812</a></p>
<p><a href="https://github.com/raspberrypi/documentation/blob/master/documentation/asciidoc/computers/raspberry-pi/spi-bus-on-raspberry-pi.adoc" target="_blank">https://github.com/raspberrypi/documentation/blob/master/documentation/asciidoc/computers/raspberry-pi/spi-bus-on-raspberry-pi.adoc</a></p>
					</div></div>
  </div>
</body>
</html>