<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TWSLA (TWSNMP’s Simple Log Analyzer)</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.55; color: #e2e8f0; max-width: 800px; margin: 26px auto; padding: 0 18px; background: #0a0e27; }
  h1 { color: #00d9ff; margin-bottom: 0.35em; line-height: 1.22; font-size: clamp(1.45rem, 2.1vw, 1.95rem); font-weight: 700; }
  h2, h3 { line-height: 1.28; margin: 1.1em 0 0.45em; }
  .metadata { color: #94a3b8; font-size: 0.86em; margin-bottom: 1.2em; border-bottom: 1px solid rgba(0,217,255,0.2); padding-bottom: 0.7em; }
  img { max-width: 100%; width: auto !important; height: auto !important; object-fit: contain !important; border-radius: 8px; display: block; margin: 0.6em auto; }
  a { color: #00d9ff; }
  p { margin-bottom: 0.72em; line-height: 1.58; }
  ul, ol { margin: 0.5em 0 0.9em 1.1em; }
  li { margin: 0.18em 0; }
  blockquote { border-left: 3px solid #825ee4; padding-left: 12px; margin: 0.8em 0; color: #94a3b8; }
  code { background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 3px; color: #ff79c6; }
  pre { background: rgba(0,0,0,0.4); padding: 12px; border-radius: 6px; overflow-x: auto; }
  .article-elevator { position: fixed; right: 14px; bottom: 14px; display: flex; flex-direction: column; gap: 8px; z-index: 9999; }
  .article-elevator-btn { width: 36px; height: 36px; border: 1px solid rgba(0,217,255,0.35); border-radius: 10px; background: rgba(10,14,39,0.88); color: #00d9ff; cursor: pointer; font-size: 16px; line-height: 1; }
  .article-elevator-btn:hover { background: rgba(10,14,39,1); }
  [id*="overlay"], [class*="overlay"], [id*="modal"], [class*="modal"], [id*="popup"], [class*="popup"],
  [id*="paywall"], [class*="paywall"], [id*="subscribe"], [class*="subscribe"], [id*="cookie"], [class*="cookie"],
  [id*="consent"], [class*="consent"], [id*="gdpr"], [class*="gdpr"], [role="dialog"], [aria-modal="true"] {
    display: none !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }
</style>
</head>
<body>
  <h1>TWSLA (TWSNMP’s Simple Log Analyzer)</h1>
  <div class="metadata">
    Source: Hacker News Show | Date: 2/16/2026 9:05:02 PM | <a href="https://github.com/twsnmp/twsla" target="_blank" rel="noopener noreferrer">Lien</a> | Lang: EN
  </div>
  <div class="content">
    <div><section> <h2>TWSLA (TWSNMP’s Simple Log Analyzer)</h2> <p><a href="https://goreportcard.com/report/github.com/twsnmp/twsla"><img src="https://img.shields.io/badge/go%20report-A+-brightgreen" alt="Go Report Card"></a>
<img src="https://img.shields.io/github/go-mod/go-version/twsnmp/twsla" alt="GitHub Go version">
<img src="https://img.shields.io/github/v/release/twsnmp/twsla" alt="GitHub release (latest by date)">
<img src="https://img.shields.io/github/license/twsnmp/twsla" alt="GitHub License">
<img src="https://img.shields.io/badge/platform-Windows%20%7C%20macOS%20%7C%20Linux-lightgrey" alt="Platform"></p> <p>TWSLA is a lightning-fast, zero-config CLI log analyzer. Designed for sysadmins who need to grep, count, and visualize patterns from massive logs instantly without setting up complex ELK stacks.</p> <p><img src="https://twsnmp.github.io/twsla/images/2026-02-15_09-59-54.png" alt="TWSLA Demo"></p> <hr> <p>TWSLA is a simple log analysis tool of the TWSNMP series.
Works on Linux/Mac OS/Windows.</p> <p><a href="https://twsnmp.github.io/twsla/README-ja.html">日本語のREADME</a></p> <h2>Install</h2> <div><pre><code><span>$</span><span> </span>curl <span>-sS</span> https://lhx98.linkclub.jp/twise.co.jp/download/install.sh | sh
</code></pre></div> <p>On Linux/macOS, it can also be installed via Homebrew.</p> <div><pre><code><span>$</span><span> </span>brew <span>install </span>twsnmp/tap/twsla
</code></pre></div> <p>On Windows, download the zip file from the releases page or install via scoop.</p> <div><pre><code><span>&gt;</span><span> </span>scoop bucket add twsnmp https://github.com/twsnmp/scoop-bucket
<span>&gt;</span><span> </span>scoop <span>install </span>twsla
</code></pre></div> <h2>Basic usage</h2> <ul> <li>Create a work directory.</li> <li>cd to that directory.</li> <li>Import the log with the import command.</li> <li>search commands are searched.</li> <li>The results can be output such as CSV.</li>
</ul> <div><pre><code>~$mkdir test
~$cd test
~$twsla import -s &lt;Log file path&gt;
~$twsla search
</code></pre></div> <h2>Command explanation</h2> <p><a href="https://twsnmp.github.io/twsla/cli-map.html">Command system</a></p> <p><a href="https://twsnmp.github.io/twsla/cli-map-v.html">Illustration of command system</a></p> <p>You can check the commands that support the Help command.</p> <div><pre><code>$twsla help
Simple Log Analyzer by TWSNMP Usage: twsla [command] Available Commands: ai AI-powered log analysis anomaly Anomaly log detection completion Generate the autocompletion script for the specified shell count Count log delay Search for delays in the access log email Search or count email logs extract Extract data from log heatmap Command to tally log counts by day of the week and time of day help Help about any command import Import log from source mcp MCP server relation Relation Analysis search Search logs. sigma Detect threats using SIGMA rules tfidf Log analysis using TF-IDF time Time analysis twlogeye Inmport notify,logs and report from twlogeye twsnmp Get information and logs from TWSNMP FC version Show twsla version Flags: --config string config file (default is $HOME/.twsla.yaml) -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -h, --help help for twsla -v, --not string Invert regexp filter -r, --regex string Regexp filter --sixel show chart by sixel -t, --timeRange string Time range Use "twsla [command] --help" for more information about a command.
</code></pre></div> <p>When the command is illustrated</p> <p><img src="https://assets.st-note.com/img/1731635423-vj6JTY1yz0eEg9l4pdIskRKh.png?width=1200" alt=""></p> <h3>import command</h3> <p>This command imports logs and saves them in a searchable time-series database. The command arguments are:</p> <div><pre><code>＄twsla help import
Import log from source
source is file | dir | scp | ssh | twsnmp | imap | pop3 Usage: twsla import [flags] Flags: --api TWSNMP FC API Mode -c, --command string SSH Command --emailPassword string IMAP or POP3 password --emailTLS IMAP use start TLS --emailUser string IMAP or POP3 user name -p, --filePat string File name pattern -h, --help help for import --imapFolder List IMAP folder names -k, --key string SSH Key -l, --logType string TWSNNP FC log type (default "syslog") --noDelta Disable delta check --noTS Import no time stamp file -b, --size int Batch Size (default 10000) --skip TWSNMP FC API skip verify certificate (default true) -s, --source string Log source --tls TWSNMP FC API TLS --utc Force UTC Global Flags: --config string config file (default is $HOME/.twsla.yaml) -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter --sixel show chart by sixel -t, --timeRange string Time range
</code></pre></div> <p>Specify the location of the log to read with <code>-s</code> or <code>--source</code>.
In the latest version, you can specify files and directory names as arguments without the <code>-s</code> option.
If you specify a file, only that file will be read.</p> <p>If it runs:</p> <div><pre><code><span>＄twsla import ~/Downloads/SSH.tag.gz
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│/ Loading path=/Users/ymi/Downloads/SSH.tar.gz:SSH.log line=655,147 byte=72 MB │
│ Total file=1 line=655,147 byte=72 MB time=1.709061625s │
│▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█████████████████████████ 72 MB/Sec│
└─────────────────────────────────────────────────────────────────────────────────────────┘
</span></code></pre></div> <p>It displays the number of logs, size, and the time taken.
When you specify a directory, it reads the files in that directory. If you specify a file pattern with <code>-p</code> or <code>--filePat</code>, you can limit the files read from the directory. This uses a simple filter.</p> <div><pre><code>＄twsla import -s ~/Downloads -p "Linux*" / Loading path=/Users/ymimacmini/Downloads/Linux_2k.log line=2,000 byte=212 kB Total file=1 line=2,000 byte=212 kB time=75.410115ms
</code></pre></div> <p>Starting with v1.17.0, the import status display has changed.</p> <p><img src="https://assets.st-note.com/img/1758319263-BqyMKkbUO0PT91w75IvZucgi.png?width=1200" alt=""></p> <p>Displays sparklines.</p> <p>You can also specify the filename pattern when reading from a ZIP or Tar.gz file.</p> <p>When reading, you can specify a simple filter, regular expression filter, and time range to reduce the amount of data imported.</p> <p>To read SCP, SSH, or TWSNMP logs, specify the URL:</p> <p><code>scp://root@192.168.1.210/var/log/messages</code></p> <p>SSH key is required.
Compatible with TWSNMP FC’s web API from v1.4.0.
Specify <code>twsnmp://192.168.1.250:8080</code> in the URL of the <code>-s</code> option.
If you specify <code>--api</code>, you can import logs via the Web API.
<code>--logType</code> can also obtain logs other than syslog.</p> <p>From v1.20.0, support for importing from IMAP, POP3, and email files (.eml) has been added.</p> <p>To import from an IMAP server:
<code>imap://user:password@imap.example.com:993/INBOX</code></p> <p>To list IMAP folders:
<code>twsla import --imapFolder -s imap://user:password@imap.example.com:993</code></p> <p>To import from a POP3 server:
<code>pop3://user:password@pop3.example.com:995</code></p> <p>You can also specify user and password via flags:
<code>twsla import -s imap://imap.example.com --emailUser user --emailPassword password --emailTLS</code></p> <p>To import from an email file (.eml):
<code>twsla import sample.eml</code></p> <p>If you specify <code>--json</code> when reading an EVTX file from v1.1.0, the Windows event log is read in JSON format, allowing detailed information to be displayed.</p> <p><img src="https://assets.st-note.com/img/1717709455800-myzsaGfpvI.png?width=1200" alt=""></p> <p>The log destination is specified with the <code>-d</code> option (bbolt database). If you omit it, it defaults to <code>twsla.db</code> in the current directory.
By specifying <code>--noDelta</code> from v1.8.0, it is possible to skip the time difference calculation to speed up the process.
Importing is faster when logs are in chronological order. Random logs are slower.</p> <h3>search command</h3> <p>You can search once the logs are imported.</p> <div><pre><code>twsla help search
Search logs.
Simple filters, regular expression filters, and exclusion filters can be specified. Usage: twsla search [flags] Flags: -c, --color string Color mode -h, --help help for search Global Flags: --config string config file (default is $HOME/.twsla.yaml) -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter -t, --timeRange string Time range
</code></pre></div> <p>You can narrow down the logs by specifying a simple filter, regular expression filter, and time range. In the current version, it acts as an inverted filter when starting with a simple filter argument.</p> <div><pre><code>＄twsla search -f fail
</code></pre></div> <p>Example search:</p> <p><img src="https://assets.st-note.com/img/1716672574781-gcWleWK4jC.png?width=1200" alt=""></p> <p>A key input help is displayed at the top right of the search result screen.
You can save the result with the <code>S</code> key. The display is reversed with the <code>R</code> key. <code>Q</code> key exits.
Log search results can be color-coded since v1.5.0.
Specify <code>-c</code> or <code>--color</code> as an option for the <code>search</code> command. For the key:</p> <table> <thead> <tr> <th>Key</th> <th>Descr</th> </tr> </thead> <tbody> <tr> <td>IP</td> <td>Color display of IP address</td> </tr> <tr> <td>Mac</td> <td>Color display of MAC address</td> </tr> <tr> <td>Email</td> <td>Color display of email address</td> </tr> <tr> <td>URL</td> <td>Color display of URL</td> </tr> <tr> <td>Filter</td> <td>Color display of the string specified in the filter</td> </tr> <tr> <td>REGEXP/Pattern/Color</td> <td>Display the string that matches the regular expression in the specified color</td> </tr> </tbody>
</table> <p>Example:</p> <div><pre><code>twsla search -f Failed -c "regex/user\s+\S+/9,ip,filter"
</code></pre></div> <p><img src="https://assets.st-note.com/img/1726436365-hzP1IyTxiYNnQGakBf2pb6uL.png?width=1200" alt=""></p> <p>From v1.6.0, you can specify color displays from the search results screen.
Press the <code>C</code> key to display the input screen. When you press the <code>M</code> key:</p> <p><img src="https://assets.st-note.com/img/1729478132-JVbuz3MD1LrvKYPxFHmAnpSg.png?width=1200" alt=""></p> <p>Displays the marker input screen. Following <code>simple filter</code> or <code>regex:</code>, you can specify a regular expression filter and mark the corresponding strings in the log. This is an example of an IP color and a marker for “Fail”.</p> <p><img src="https://assets.st-note.com/img/1729484628-MxPyZJRoNU0bqCkeXmh7cAEG.png?width=1200" alt=""></p> <h3>count command</h3> <p>This command aggregates the number of logs on an hourly basis, or uses data extracted from the log as a key.</p> <div><pre><code><span>＄twsla help count
Count the number of logs.
Count logs for each specified period.
Number of occurrences of items extracted from the log.
Count normalized logs by pattern:
</span><span> $</span>twsla count <span>-e</span> normalize
<span>Count words in logs:
</span><span> $</span>twsla count <span>-e</span> word
<span>Count JSON keys:
</span><span> $</span>twsla count <span>-e</span> json <span>-n</span> Score
<span>
Usage: twsla count [flags] Flags: --delay int Delay filter -e, --extract string Extract pattern or mode. mode is json,grok,word,normalize --geoip string geo IP database file -g, --grok string grok pattern definitions -x, --grokPat string grok pattern -h, --help help for count -i, --interval int Specify the aggregation interval in seconds. --ip string IP info mode(host|domain|loc|country) -n, --name string Name of key -p, --pos int Specify variable location (default 1) -q, --timePos int Specify second time stamp position --utc Force UTC Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter --sixel show chart by sixel -t, --timeRange string Time range
</span></code></pre></div> <p>You can filter in the same way as search.
If an extraction pattern is specified with the <code>-e</code> option, the data is aggregated by those units. If omitted, logs are aggregated by time.
Hourly aggregation:</p> <div><pre><code><span>$</span>twsla count <span>-f</span> fail
</code></pre></div> <p><img src="https://assets.st-note.com/img/1717709793390-R450RHfeJN.png?width=1200" alt=""></p> <p>The time interval is specified with the <code>-i</code> option. If omitted, it is set automatically.
From v1.1.0, the time difference (Delta) from the previous log is also displayed. The average interval is shown at the top.
You can sort by count with the <code>C</code> key, or by time with the <code>K</code> key.
You can save the result with the <code>S</code> key. Saving with a <code>.png</code> extension will generate a graph.</p> <p><img src="https://assets.st-note.com/img/1716674447895-OPrP8zMSUQ.png?width=1200" alt=""></p> <p>From v1.5.0, you can save interactive graphs by using the <code>.html</code> extension.</p> <p><img src="https://assets.st-note.com/img/1716674531194-O7j5QXhIHo.png?width=1200" alt=""></p> <p>The TOP10 ratio graph looks like this:</p> <p><img src="https://assets.st-note.com/img/1716674623362-MkHGX4qUZ2.png?width=1200" alt=""></p> <p>A delay time filter was added in v1.16.0.</p> <div><pre><code>--delay &lt;number&gt;
</code></pre></div>
<p>Specifying this will cause the command to display logs with a delay higher than the specified number.</p> <div><pre><code> -q, --timePos int Specify second time stamp position --utc Force UTC
</code></pre></div>
<p>This mode detects the time difference between two timestamps in the log, similar to the <code>delay</code> command.</p> <h3>email command</h3> <p>This command allows searching and counting email logs stored in the database.
It provides subcommands to search for specific emails or count emails by various fields such as From, To, Subject, Sender IP, and SPF status.
In the search results, you can check the delay time and relay count calculated from the email headers.
You can sort by delay with the <code>d</code> key and by relay count with the <code>r</code> key.</p> <div><pre><code><span>twsla email [search|count]
</span></code></pre></div> <p>Examples:</p>
<div><pre><code> twsla email search -t "last 1h" twsla email count --emailCountBy from -t "last 24h"
</code></pre></div> <h3>extract command</h3> <p>This command extracts specific data from the logs.</p> <div><pre><code><span>$</span>twsla <span>help </span>extract
<span>Extract data from the log.
Numeric data, IP addresses, MAC addresses, email addresses,
words, etc. can be extracted. Usage: twsla extract [flags] Flags: -e, --extract string Extract pattern --geoip string geo IP database file -h, --help help for extract -n, --name string Name of value (default "Value") -p, --pos int Specify variable location (default 1) Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter -t, --timeRange string Time range
</span></code></pre></div> <p>You can specify the same filters as the <code>search</code> command. Data extraction patterns are specified the same way as the <code>count</code> command.</p> <div><pre><code><span>$</span>twsla extract <span>-f</span> fail <span>-e</span> ip
</code></pre></div> <p><img src="https://assets.st-note.com/img/1716674893720-WqYN0wwrvt.png?width=1200" alt=""></p> <p>This displays time-series data. You can sort by key and save results as a graph.</p> <p><img src="https://assets.st-note.com/img/1716675034354-UvMuVYryxl.png?width=1200" alt=""></p> <p>Numerical data is graphed directly, while items like IP addresses are graphed by occurrence count.</p> <p><img src="https://assets.st-note.com/img/1736891736-Mg2ahHbtJqSws7KPcUznTvkQ.png?width=1200" alt=""></p> <p>Press the <code>i</code> key while numerical data is extracted to display statistical information.</p> <p><img src="https://assets.st-note.com/img/1736891837-3wLoHPGn5ANfEsgDmyqxTKVh.png?width=1200" alt=""></p> <p>Press the <code>s</code> key to save as CSV.</p> <h3>tfidf command</h3> <p>Find rare logs using TF-IDF.</p> <div><pre><code><span>＄twsla help tfidf
Use TF-IDF to find rare logs.
You can specify a similarity threshold and the number of times the threshold is allowed to be exceeded. Usage: twsla tfidf [flags] Flags: -c, --count int Number of threshold crossings to exclude -h, --help help for tfidf -l, --limit float Similarity threshold between logs (default 0.5) -n, --top int Top N Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter -t, --timeRange string Time range
</span></code></pre></div> <p><img src="https://assets.st-note.com/img/1716675268711-yeoAjdEYAx.png?width=1200" alt=""></p> <p>The example shows three rare logs found in 2,000 entries. Thresholds can be adjusted with <code>-l</code> and <code>-c</code>. Detailed information for experts will be provided in another article.
Since v1.10, you can use <code>-n</code> to get the top N rare cases.</p> <h3>anomaly command</h3> <p>Added in v1.1.0, this command analyzes logs to find anomalies.</p> <div><pre><code><span>
Anomaly log detection Detect anomaly logs using isolation forests. Detection modes include walu, SQL injection, OS command injections, and directory traverses. Usage: twsla anomaly [flags] Flags: -e, --extract string Extract pattern -h, --help help for anomaly -m, --mode string Detection modes(tfidf|sql|os|dir|walu|number) (default "tfidf") Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter -t, --timeRange string Time range
</span></code></pre></div> <p>Specify the mode with <code>-m</code>. <code>tfidf</code> creates log vectors using TF-IDF. <code>sql</code>, <code>os</code>, and <code>dir</code> create vectors based on keywords related to those attacks. <code>number</code> creates vectors from numerical values in the log.
Numerical positions can be specified with <code>-e</code>.</p> <div><pre><code>start*end
</code></pre></div> <p>Example:</p> <div><pre><code>11:00 start 0.1 0.2 1.4 end
</code></pre></div> <p>Only the values between <code>start</code> and <code>end</code> will be analyzed.</p> <p>Analysis results:</p> <p><img src="https://assets.st-note.com/img/1717710550350-NG6evcVbRm.png?width=1200" alt=""></p> <p>Higher scores indicate greater anomalies. <code>sql</code> and <code>walu</code> modes are effective for web server access logs.</p> <h3>delay command</h3> <p>Added in v1.3.0, this command detects processing delays from access logs. Apache’s access log records the timestamp when a request is accepted, but outputs the entry after the response is sent. This can cause timestamps to appear out of order. This reversal can be used to detect delays in processing requests or downloading large files.
It can also detect delays between timestamps when access logs are transferred to syslog with multiple timestamps.</p> <div><pre><code><span>Search for delays in the access log Usage: twsla delay [flags] Flags: -h, --help help for delay -q, --timePos int Specify second time stamp position --utc Force UTC Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter -t, --timeRange string Time range
</span></code></pre></div> <p>If <code>-q</code> is 1 or more, it processes multiple timestamps. If omitted or 0, it detects delays using the Apache access log reversal phenomenon.</p> <p><img src="https://assets.st-note.com/img/1723064539386-Xo4AG4qm3Y.png?width=1200" alt=""></p> <p>If no delays are detected, nothing is displayed. The rightmost column shows the delay time. Select a log and press <code>Enter</code> for details. Sort by time with <code>T</code> or by delay with <code>D</code>. Save with <code>S</code>; using <code>.png</code> saves a graph image.</p> <p><img src="https://assets.st-note.com/img/1723064799604-VwdzrZ3bSg.png?width=1200" alt=""></p> <h3>twsnmp command</h3> <p>This command links with TWSNMP FC (added in v1.4.0).</p> <div><pre><code><span>Get information and logs from TWSNMP FC
[target] is node | polling | eventlog | syslog | trap | netflow | ipfix | sflow |sflowCounter | arplog | pollingLog Usage: twsla twsnmp [target] [flags] Flags: --checkCert TWSNMP FC API verify certificate -h, --help help for twsnmp --jsonOut output json format --twsnmp string TWSNMP FC URL (default "http://localhost:8080") Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter -t, --timeRange string Time range
</span></code></pre></div> <p>Specify the TWSNMP FC URL with <code>--twsnmp</code>. Include credentials if necessary:
<code>http://user:password@192.168.1.250:8080</code></p> <p>Example: Fetching the node list:</p> <div><pre><code><span>twsla twsnmp node --twsnmp http://192.168.1.253:8081
17ea9e198e6dce8e eve-ng-ymi. normal 192.168.13.1
17ea9e1c9574f616 192.168.13.2 low 192.168.13.2 00:50:79:66:68:05(Private)
</span><span>...
</span></code></pre></div> <p>Outputs are tab-separated text by default. Use <code>--jsonOut</code> for JSON format, which is useful for programmatic access.</p> <h3>relation command</h3> <p>Analyzes relationships between multiple items in log lines. Results can be output as an interactive graph.</p> <div><pre><code><span>$</span>twsla <span>help </span>relation
<span>Analyzes the relationship between two or more pieces of data extracted from a log,
such as the relationship between an IP address and a MAC address.
</span><span>data entry is ip | mac | email | url | regex/&lt;pattern&gt;</span>/&lt;color&gt;
<span>
Usage:
</span><span> twsla relation &lt;data1&gt;</span><span> </span>&lt;data2&gt;... <span>[</span>flags]
<span>
Flags: -h, --help help for relation Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter -t, --timeRange string Time range
</span></code></pre></div> <p>Supported items:</p> <table> <thead> <tr> <th>key</th> <th>descr</th> </tr> </thead> <tbody> <tr> <td>IP</td> <td>IP address</td> </tr> <tr> <td>Mac</td> <td>MAC address</td> </tr> <tr> <td>Email</td> <td>Email address</td> </tr> <tr> <td>URL</td> <td>URL</td> </tr> <tr> <td>REGEXP/Pattern/</td> <td>String matching regular expression</td> </tr> </tbody>
</table> <div><pre><code><span>$</span>twsla relation <span>-f</span> Failed <span>-r</span> user <span>"regex/user</span><span>\s</span><span>+</span><span>\S</span><span>+/"</span> ip
</code></pre></div> <p><img src="https://assets.st-note.com/img/1726436651-dajM1gPELX8vny6GBW5Yz9b7.png?width=1200" alt=""></p> <p>Aggregations can be viewed as an interactive graph by saving with the <code>.html</code> extension.</p> <p><img src="https://assets.st-note.com/img/1726436651-c86jxm75eoIZaDSHNuBr9Cd1.png?width=1200" alt=""></p> <h3>heatmap command</h3> <p>Displays log frequency over time or date using a heat map.</p> <div><pre><code><span>twsla help heatmap
Command to tally log counts by day of the week and time of day Aggregate by date mode is also available. Usage: twsla heatmap [flags] Flags: -h, --help help for heatmap -w, --week Week mode Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter -t, --timeRange string Time range
</span></code></pre></div> <p>Use <code>-w</code> for weekly aggregation; otherwise, it aggregates by date.</p> <p>Date-based heat map:</p> <p><img src="https://assets.st-note.com/img/1726436714-pUIb1AKFhWPGuxLV2gelzRJM.png?width=1200" alt=""></p> <p>Saved as HTML:</p> <p><img src="https://assets.st-note.com/img/1726436714-pb7ZIGOX6tPBoHY4aChR9Jzk.png?width=1200" alt=""></p> <p>Weekly heat map:</p> <p><img src="https://assets.st-note.com/img/1726436714-UjtvDC3bVpgRHYa9hK47yfkd.png?width=1200" alt=""></p> <h3>time command</h3> <p>Analyzes time differences between logs (added in v1.6.0).</p> <div><pre><code><span>Time analysis Usage: twsla time [flags] Flags: -h, --help help for time Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter -t, --timeRange string Time range </span></code></pre></div> <p><img src="https://assets.st-note.com/img/1729485261-4NeIF2sytM0lxYwTrnHfikQg.png?width=1200" alt=""></p> <p><code>Diff</code> shows the difference from the marked log. <code>Delta</code> shows the difference from the previous log. Selecting a log displays detailed statistics (Mean, Median, Mode, StdDev). Use <code>M</code> to mark a log. Graphs of Delta can be saved as HTML or PNG.</p> <p><img src="https://assets.st-note.com/img/1729485332-0ES73fO8nqMzcLBZQtsomj19.png?width=1200" alt=""></p> <h3>sigma command</h3> <p>Detects threats using the standard SIGMA format (https://sigmahq.io/).</p> <div><pre><code><span>Detect threats using SIGMA rules. About SIGMA https://sigmahq.io/ Usage: twsla sigma [flags] Flags: -c, --config string config path -g, --grok string grok definitions -x, --grokPat string grok pattern if empty json mode -h, --help help for sigma -s, --rules string Sigma rules path --strict Strict rule check Global Flags: -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter -t, --timeRange string Time range
</span></code></pre></div> <p>Specify the SIGMA rules directory with <code>-s</code>. Logs are expected in JSON format; non-JSON logs require GROK extraction via <code>-g</code> and <code>-x</code>. Use <code>-c Windows</code> for built-in Windows event log mappings.</p> <p><img src="https://assets.st-note.com/img/1731635833-qlgh6Id4OZj27BNMse8aYSQP.png?width=1200" alt=""></p> <p>Detected rules are displayed. Press <code>Enter</code> for details, <code>C</code> for rule-based display, or <code>G</code>/<code>H</code> for graphs. Save data/graphs with <code>S</code>.</p> <h3>twlogeye command</h3> <p>Imports notifications, logs, and reports from TwLogEye.</p> <p>https://twsnmp.github.io/twlogeye/
https://github.com/twsnmp/twlogeye</p> <div><pre><code><span>Import notify, logs and reports from TwLogEye
</span><span>twsla twlogeye &lt;target&gt;</span><span> </span><span>[</span>&lt;sub target&gt;] <span>[</span>&lt;anomaly report <span>type</span><span>&gt;]</span>
<span> target: notify | logs | report logs sub target: syslog | trap | netflow | winevent | otel | mqtt report sub target: syslog | trap | netflow | winevent | otel | mqtt | monitor | anomaly anomaly report type: syslog | trap | netflow | winevent | otel | mqtt | monitor | anomaly Usage: twsla twlogeye [flags] Flags: --anomaly string Anomaly report type (default "monitor") --apiPort int twlogeye api port number (default 8081) --apiServer string twlogeye api server ip address --ca string CA Cert file path --cert string Client cert file path --filter string Log search text -h, --help help for twlogeye --key string Client key file path --level string Notify level Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -v, --not string Invert regexp filter -r, --regex string Regexp filter --sixel show chart by sixel -t, --timeRange string Time range
</span></code></pre></div> <h3>ai command</h3> <p>Analyzes logs using LLM (significant updates in v1.17.0).</p> <p><img src="https://assets.st-note.com/img/1758318692-ujPGHdgEcA40JOQLNhCVz7bU.png?width=1200" alt=""></p> <div><pre><code><span>AI-powered log analysis
Using environment variables for API keys: GOOGLE_API_KEY : gemini ANTHROPIC_API_KEY : claude OPENAI_API_KEY : openai Usage:
</span><span> twsla ai &lt;filter&gt;</span>... <span>[</span>flags]
<span>
Flags: --aiBaseURL string AI base URL --aiErrorLevels string Words included in the error level log (default "error,fatal,fail,crit,alert") --aiLang string Language of the response --aiModel string LLM Model name --aiProvider string AI provider(ollama|gemini|openai|claude) --aiSampleSize int Number of sample logs to be analyzed by AI (default 50) --aiTopNError int Number of error log patterns to be analyzed by AI (default 10) --aiWarnLevels string Words included in the warning level log (default "warn") --aiNoMask Do not mask PII in logs -h, --help help for ai Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter --sixel show chart by sixel -t, --timeRange string Time range
</span></code></pre></div> <p>Specify provider, model, and filters. Environment variables are used for API keys. Ollama requires no key.</p> <p>Starting with v1.21.0, PII (Personally Identifiable Information) such as IP addresses, email addresses, and phone numbers are automatically masked before being sent to the AI for analysis. Use the <code>--aiNoMask</code> flag if you want to send the original logs without masking.</p> <p>Example:</p>
<div><pre><code><span>$</span>twsla ai <span>--aiProvider</span> ollama <span>--aiModel</span> qwen3:latest &lt;Filter&gt;
</code></pre></div> <p><img src="https://assets.st-note.com/img/1758318933-VnEzfqCPXT3a9hY0k6KLpy1o.png?width=1200" alt=""></p> <p>Select a log and press <code>e</code> for an AI explanation, or <code>a</code> for a summary of all searched logs.</p> <p><img src="https://assets.st-note.com/img/1758352154-IHNFWpQdTta6fS97AD8e2nGV.png?width=1200" alt="">
<img src="https://assets.st-note.com/img/1758352084-BnFKucxeG4mqSoYCT6tNprH3.png?width=1200" alt=""></p> <h3>mcp command</h3> <p>MCP (Model Context Protocol) server for AI agents.</p> <div><pre><code><span>$</span>twsla <span>help </span>mcp
<span>MCP server for AI agent Usage: twsla mcp [flags] Flags: --clients string IP address of MCP client to be allowed to connect (comma-separated) --endpoint string MCP server endpoint (default "127.0.0.1:8085") --geoip string geo IP database file -h, --help help for mcp --transport string MCP server transport(stdio/sse/stream) (default "stdio") Global Flags:
</span><span> --config string config file (default is $</span>HOME/.twsla.yaml<span>)</span>
<span> -d, --datastore string bblot log db (default "./twsla.db") -f, --filter string Simple filter -v, --not string Invert regexp filter -r, --regex string Regexp filter --sixel show chart by sixel -t, --timeRange string Time range
</span></code></pre></div> <h4>System Prompt for MCP Server Tools</h4> <div><pre><code># TWSLA Log Analysis AI - System Prompt You are an AI assistant for TWSLA (TWSNMP Log Analyzer). Your primary role is to help users analyze logs stored in the TWSLA database. You can search, count, extract data, and summarize logs. ## Available Tools To interact with the TWSLA log database, you have access to the following tools: ### 1. `search_log` Use this tool to search for log entries matching specific criteria. **Parameters:** * `filter` (string, optional): Regular expression to filter logs. If empty, no filter is applied.
* `limit` (integer, optional): Maximum number of log entries to return. (Min: 100, Max: 10000, Default: 100)
* `start` (string, optional): Start date and time for the search (e.g., "2025/10/26 11:00:00"). If empty, starts from the beginning.
* `end` (string, optional): End date and time for the search (e.g., "2025/10/26 12:00:00"). If empty, defaults to current time. **Example:**
To search for logs containing "error" in the last hour:
`search_log(filter="error", start="-1h")` ### 2. `count_log` Use this tool to count log entries grouped by a specific unit. This is useful for statistical analysis. **Parameters:** * `filter` (string, optional): Regular expression to filter logs before counting.
* `unit` (string, optional): Unit of counting. (Default: "time") * `time`: Group by time intervals. * `ip`: Group by source IP address. * `email`: Group by email address. * `mac`: Group by MAC address. * `host`: Group by hostname (requires DNS resolution). * `domain`: Group by domain name. * `country`: Group by country (requires GeoIP database). * `loc`: Group by geographic location (requires GeoIP database). * `word`: Group by individual words in the log message. * `field`: Group by a specific field (space-separated). * `normalize`: Group by normalized log patterns.
* `unit_pos` (integer, optional): Position of the unit if `unit` is "field". (Default: 1)
* `top_n` (integer, optional): Number of top results to return. (Default: 10)
* `interval` (integer, optional): Aggregation interval in seconds if `unit` is "time". (Default: auto)
* `start` (string, optional): Start time for the search.
* `end` (string, optional): End time for the search. **Example:**
To count the top 10 source IP addresses in the last 24 hours:
`count_log(unit="ip", top_n=10, start="-24h")` ### 3. `extract_data_from_log` Use this tool to extract specific information (IP addresses, email addresses, custom patterns, etc.) from log entries. **Parameters:** * `filter` (string, optional): Regular expression to filter logs before extraction.
* `pattern` (string, required): Pattern of data to extract. * `ip`, `mac`, `email`, `number` * Or a custom regular expression.
* `pos` (integer, optional): Position of data to extract if multiple matches are found. (Default: 1)
* `start` (string, optional): Start time for the search.
* `end` (string, optional): End time for the search. **Example:**
To extract all IP addresses from logs containing "failed login" in the last day:
`extract_data_from_log(filter="failed login", pattern="ip", start="-1d")` ### 4. `import_log` Use this tool to import new logs into the TWSLA database from a file or directory. **Parameters:** * `path` (string, required): Path to the log file or directory. Can handle compressed files like `.zip`, `.tar.gz`, `.gz`.
* `pattern` (string, optional): Regular expression to filter filenames within a directory or archive. **Example:**
To import all `.log` files from the `/var/log/` directory:
`import_log(path="/var/log/", pattern=".*\.log")` ### 5. `get_log_summary` Use this tool to get an overview of logs for a specified period. The summary includes total entries, error and warning counts, and top error patterns. **Parameters:** * `filter` (string, optional): Regular expression to filter logs.
* `top_n` (integer, optional): Number of top error patterns to return. (Default: 10)
* `start` (string, optional): Start time for the summary.
* `end` (string, optional): End time for the summary. **Example:**
To get a summary of all logs from yesterday:
`get_log_summary(start="-1d", end="today")` ## General Instructions * Always analyze the user's request carefully to choose the most appropriate tool.
* When dealing with time, you can use relative periods (e.g., "-1h", "-24h") or absolute timestamps.
* Combine tools to answer complex questions. For example, use `search_log` first to get an overview of data, then use `count_log` or `extract_data_from_log` for detailed analysis.
* If the user's request is ambiguous, ask for clarification before running any tools.
</code></pre></div> <h4>MCP Server Configuration</h4> <ul> <li><strong>Transport</strong>: <code>stdio</code> (console), <code>sse</code> (server-sent events), or <code>stream</code> (HTTP with client filtering).</li> <li><strong>Endpoint</strong>: Default <code>127.0.0.1:8085</code>.</li> <li><strong>Clients</strong>: Whitelist of IP addresses specified as comma-separated values.</li>
</ul> <h3>completion command</h3> <p>Generates shell autocompletion scripts for <code>bash</code>, <code>fish</code>, <code>powershell</code>, and <code>zsh</code>.</p> <p>Bash (Linux):</p>
<div><pre><code><span>$</span><span> </span>twsla completion bash | <span>sudo tee</span> /etc/bash_completion.d/twsla
</code></pre></div> <p>Zsh (macOS):</p>
<div><pre><code><span>$</span><span> </span><span>mkdir</span> <span>-p</span> ~/.zsh/completion/
<span>$</span><span> </span>twsla completion zsh <span>&gt;</span> ~/.zsh/completion/_twsla
</code></pre></div>
<p>Add to <code>~/.zshrc</code>:</p>
<div><pre><code><span>fpath</span><span>=(</span>~/.zsh/completion <span>$fpath</span><span>)</span>
autoload <span>-Uz</span> compinit <span>&amp;&amp;</span> compinit <span>-i</span>
</code></pre></div> <p>PowerShell (Windows):</p>
<div><pre><code><span>&gt;</span><span> </span>twsla completion powershell | Out-String | Invoke-Expression
</code></pre></div> <h3>version command</h3>
<p>Displays the <code>twsla</code> version.</p> <div><pre><code><span>$</span><span> </span>twsla version
<span>twsla v1.17.0(94cb1ad24408c2dc38f7d178b2d78eaf5f6ad600) 2024-12-15T21:07:47Z
</span></code></pre></div> <h2>Basic explanation</h2> <h3>Supported logs</h3> <ul> <li>Text files with timestamps per line</li> <li>Windows EVTX format</li> <li>TWSNMP’s internal logs</li>
</ul> <p>Supports ZIP, Tar.gz, and GZ compression. Timestamps are automatically detected. SCP/SSH and TWSNMP FC/FK imports are also supported.</p> <h3>Simple filter</h3> <table> <thead> <tr> <th>Keyword</th> <th>Descr</th> </tr> </thead> <tbody> <tr> <td>#IP</td> <td>Contains IP address</td> </tr> <tr> <td>#IPV6</td> <td>Contains IPv6 address</td> </tr> <tr> <td>#MAC</td> <td>Contains MAC address</td> </tr> <tr> <td>#LOCAL_IP</td> <td>Contains local IP address</td> </tr> <tr> <td>#EMAIL</td> <td>Contains email address</td> </tr> <tr> <td>#URL</td> <td>Contains URL</td> </tr> <tr> <td>#CREDITCARD</td> <td>Contains Credit Card number</td> </tr> <tr> <td>#MYNUMBER</td> <td>Contains My Number (Japan)</td> </tr> <tr> <td>#PHONE_JP</td> <td>Contains Japanese phone number</td> </tr> <tr> <td>#PHONE_US</td> <td>Contains US phone number</td> </tr> <tr> <td>#PHONE_INTL</td> <td>Contains international phone number</td> </tr> <tr> <td>#ZIP_JP</td> <td>Contains Japanese zip code</td> </tr> <tr> <td>#UUID</td> <td>Contains UUID</td> </tr> </tbody>
</table> <h3>Exclusion filter</h3> <p>Exclude lines using the same logic as <code>grep -v</code>.</p> <h3>Time range</h3> <p>Flexible input formats:</p>
<ul> <li><code>2024/01/01T00:00:00+0900-2024/01/02T00:00:00+0900</code></li> <li><code>2024/1/1,1d</code> (Start, duration)</li>
</ul> <p>Supported keys for <code>-e</code>: <code>IP</code>, <code>IPV6</code>, <code>MAC</code>, <code>Number</code>, <code>Email</code>, <code>CREDITCARD</code>, <code>MYNUMBER</code>, <code>PHONE_JP</code>, <code>PHONE_US</code>, <code>PHONE_INTL</code>, <code>ZIP_JP</code>, <code>UUID</code>, <code>LOC</code>, <code>Country</code>, <code>HOST</code>, <code>Domain</code>. Use <code>-p</code> to specify which occurrence to extract. Custom patterns like <code>count=%{number}</code> are also supported.</p> <h3>GROK and JSON modes</h3> <p>Advanced extraction since v1.7.0.</p>
<ul> <li><strong>GROK:</strong> Use <code>-e grok -x &lt;pattern&gt;</code>.</li> <li><strong>JSON:</strong> Use <code>-e json -n &lt;jsonpath&gt;</code>.</li>
</ul> <h3>Graphs</h3> <p>Save graphs as PNG or view interactive HTML versions. Graphs can also be displayed in the terminal using Sixel (<code>--sixel</code>).</p> <h3>IP Information (DNS/GeoIP)</h3> <p>Enrich logs with GeoIP and DNS information. Requires a GeoLite2 database for <code>loc</code> and <code>country</code> modes.</p> <div><pre><code><span>$</span><span> </span>twsla count <span>-e</span> ip <span>--ip</span> country <span>--geoip</span> ./GeoLite2-City.mmdb <span>"Failed password"</span>
</code></pre></div> <h3>Configuration and environment variables</h3> <p>Supports <code>~/.twsla.yaml</code> and environment variables like <code>TWSLA_DATASTORE</code>, <code>TWSLA_GEOIP</code>, <code>TWSLA_GROK</code>, and <code>TWSLA_SIXEL</code>.</p> <table> <thead> <tr> <th>Key</th> <th>Descr</th> </tr> </thead> <tbody> <tr> <td>timeRange</td> <td>Time range</td> </tr> <tr> <td>filter</td> <td>Simple filter</td> </tr> <tr> <td>regex</td> <td>Regular expression filter</td> </tr> <tr> <td>not</td> <td>Inverted filter</td> </tr> <tr> <td>extract</td> <td>Extraction pattern</td> </tr> <tr> <td>name</td> <td>Variable name</td> </tr> <tr> <td>grokPat</td> <td>GROK pattern</td> </tr> <tr> <td>ip</td> <td>IP Information Mode</td> </tr> <tr> <td>color</td> <td>Color Mode</td> </tr> <tr> <td>Rules</td> <td>Sigma rules path</td> </tr> <tr> <td>sigmaconfig</td> <td>Sigma settings</td> </tr> <tr> <td>twsnmp</td> <td>TWSNMP FC URL</td> </tr> <tr> <td>interval</td> <td>Aggregation intervals</td> </tr> <tr> <td>jsonOut</td> <td>JSON format output</td> </tr> <tr> <td>checkCert</td> <td>Verify server certificate</td> </tr> <tr> <td>datastore</td> <td>Datastore path</td> </tr> <tr> <td>geoip</td> <td>GeoIP DB path</td> </tr> <tr> <td>grok</td> <td>GROK definition</td> </tr> <tr> <td>sixel</td> <td>Terminal graph display</td> </tr> </tbody>
</table> <h2>Build</h2> <p>Built with <code>go-task</code>.</p>
<div><pre><code><span>$</span><span> </span>task
</code></pre></div> <h2>Copyright</h2>
<p>See <code>./LICENSE</code>
Copyright 2024-2026 Masayuki Yamai</p> </section></div>
  </div>
  <div class="article-elevator" aria-label="Navigation article">
    <button class="article-elevator-btn" type="button" onclick="scrollToTop()">▲</button>
    <button class="article-elevator-btn" type="button" onclick="scrollToBottom()">▼</button>
  </div>
  <script>
    function stripBlockingPanels() {
      const selector = '[id*="overlay"], [class*="overlay"], [id*="modal"], [class*="modal"], [id*="popup"], [class*="popup"], [id*="paywall"], [class*="paywall"], [id*="subscribe"], [class*="subscribe"], [id*="cookie"], [class*="cookie"], [id*="consent"], [class*="consent"], [id*="gdpr"], [class*="gdpr"], [role="dialog"], [aria-modal="true"]';
      const textPattern = /\b(cookie|consent|gdpr|subscribe|subscription|paywall|abonnez[-\s]?vous|inscrivez[-\s]?vous|continue reading|continuez la lecture)\b/i;
      document.querySelectorAll(selector).forEach((node) => node.remove());
      document.querySelectorAll('div, section, aside').forEach((node) => {
        const styleAttr = String(node.getAttribute('style') || '').toLowerCase();
        const classAndId = String(node.className || '').toLowerCase() + ' ' + String(node.id || '').toLowerCase();
        const text = String(node.textContent || '').slice(0, 800);
        const hasKeyword = textPattern.test(classAndId) || textPattern.test(text);
        const looksFixed = /(position\s*:\s*(fixed|sticky)|inset\s*:|top\s*:|left\s*:|right\s*:|bottom\s*:)/.test(styleAttr);
        const hasPriority = /(z-index\s*:\s*[1-9]\d{1,}|backdrop-filter|overflow\s*:\s*hidden)/.test(styleAttr);
        if (hasKeyword && (looksFixed || hasPriority)) node.remove();
      });
    }
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'auto' });
    }
    function scrollToBottom() {
      window.scrollTo({ top: document.documentElement.scrollHeight, behavior: 'auto' });
    }
    window.addEventListener('message', (event) => {
      const data = event && event.data;
      if (!data || data.type !== 'AI_PULSE_SCROLL') return;
      if (data.direction === 'up' || data.direction === 'top') scrollToTop();
      if (data.direction === 'down' || data.direction === 'bottom') scrollToBottom();
    });
    stripBlockingPanels();
    setTimeout(stripBlockingPanels, 60);
    setTimeout(stripBlockingPanels, 220);
    setTimeout(stripBlockingPanels, 650);
  </script>
</body>
</html>