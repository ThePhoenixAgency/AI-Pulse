<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>New AirSnitch attack bypasses Wi-Fi encryption in homes, offices, and enterprises</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.55; color: #e2e8f0; max-width: 800px; margin: 26px auto; padding: 0 18px; background: #0a0e27; }
  h1 { color: #00d9ff; margin-bottom: 0.35em; line-height: 1.22; font-size: clamp(1.45rem, 2.1vw, 1.95rem); font-weight: 700; }
  h2, h3 { line-height: 1.28; margin: 1.1em 0 0.45em; }
  .metadata { color: #94a3b8; font-size: 0.86em; margin-bottom: 1.2em; border-bottom: 1px solid rgba(0,217,255,0.2); padding-bottom: 0.7em; }
  img { max-width: 100%; width: auto !important; height: auto !important; object-fit: contain !important; border-radius: 8px; display: block; margin: 0.6em auto; }
  a { color: #00d9ff; }
  p { margin-bottom: 0.72em; line-height: 1.58; }
  ul, ol { margin: 0.5em 0 0.9em 1.1em; }
  li { margin: 0.18em 0; }
  blockquote { border-left: 3px solid #825ee4; padding-left: 12px; margin: 0.8em 0; color: #94a3b8; }
  code { background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 3px; color: #ff79c6; }
  pre { background: rgba(0,0,0,0.4); padding: 12px; border-radius: 6px; overflow-x: auto; }
  .article-elevator { position: fixed; right: 14px; bottom: 14px; display: flex; flex-direction: column; gap: 8px; z-index: 9999; }
  .article-elevator-btn { width: 36px; height: 36px; border: 1px solid rgba(0,217,255,0.35); border-radius: 10px; background: rgba(10,14,39,0.88); color: #00d9ff; cursor: pointer; font-size: 16px; line-height: 1; }
  .article-elevator-btn:hover { background: rgba(10,14,39,1); }
  [id*="overlay"], [class*="overlay"], [id*="modal"], [class*="modal"], [id*="popup"], [class*="popup"],
  [id*="paywall"], [class*="paywall"], [id*="subscribe"], [class*="subscribe"], [id*="cookie"], [class*="cookie"],
  [id*="consent"], [class*="consent"], [id*="gdpr"], [class*="gdpr"], [role="dialog"], [aria-modal="true"] {
    display: none !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }
</style>
</head>
<body>
  <h1>New AirSnitch attack bypasses Wi-Fi encryption in homes, offices, and enterprises</h1>
  <div class="metadata">
    Source: Ars Technica | Date: 2/26/2026 3:45:18 PM | <a href="https://arstechnica.com/security/2026/02/new-airsnitch-attack-breaks-wi-fi-encryption-in-homes-offices-and-enterprises/" target="_blank" rel="noopener noreferrer">Lien</a> | Lang: EN
  </div>
  <div class="content">
    <div><div> <article> <header> <div> <div> <p><span> </span> <span> CLOWNS TO THE LEFT, JOKERS TO THE RIGHT </span>
</p> </div> <p> That guest network you set up for your neighbors may not be as secure as you think. </p> <div> <p><a href="https://cdn.arstechnica.net/wp-content/uploads/2025/06/wi-fi.jpg" target="_blank" rel="noopener noreferrer"> <img src="https://cdn.arstechnica.net/wp-content/uploads/2025/06/wi-fi.jpg" alt="Illustration of a symbol representing radio waves for Wi-Fi networks"> </a></p><div> <p><span> Credit: Getty Image | BlackJack3D </span> </p> </div> </div> <div> <p><span> Credit: Getty Image | BlackJack3D </span> </p> </div> </div>
</header> <div> <p>It’s hard to overstate the role that Wi-Fi plays in virtually every facet of life. The organization that shepherds the wireless protocol <a href="https://www.wi-fi.org/beacon/the-beacon/powering-connected-world-wi-fi-momentum-2025">says</a> that more than 48 billion Wi-Fi-enabled devices have shipped since it debuted in the late 1990s. One <a href="https://thenetworkinstallers.com/blog/wifi-statistics/">estimate</a> pegs the number of individual users at 6 billion, roughly 70 percent of the world’s population.</p>
<p>Despite the dependence and the immeasurable amount of sensitive data flowing through Wi-Fi transmissions, the history of the protocol has been <a href="https://arstechnica.com/gadgets/2019/03/802-eleventy-who-goes-there-wpa3-wi-fi-security-and-what-came-before-it/">littered</a> with security landmines stemming both from the inherited confidentiality weaknesses of its networking predecessor, Ethernet (it was once possible for anyone on a network to <a href="https://blackhat.com/html/bh-usa-03/bh-usa-03-speakers.html">read and modify</a> the traffic sent to anyone else), and the ability for anyone nearby to receive the radio signals Wi-Fi relies on.</p>
<h2>Ghost in the machine</h2>
<p>In the early days, public Wi-Fi networks often resembled the Wild West, where <a href="https://en.wikipedia.org/wiki/ARP_spoofing">ARP spoofing</a> attacks that allowed renegade users to read other users’ traffic were common. The solution was to build cryptographic protections that prevented nearby parties—whether an authorized user on the network or someone near the AP (access point)—from reading or tampering with the traffic of any other user.</p>
<p>New research shows that behaviors that occur at the very lowest levels of the network stack make encryption—in any form, not just those that have been broken in the past—incapable of providing client isolation, an encryption-enabled protection promised by all router makers, that is intended to block direct communication between two or more connected clients.</p>
<p>The isolation can effectively be nullified through AirSnitch, the name the researchers gave to a series of attacks that capitalize on the newly discovered weaknesses. Various forms of AirSnitch work across a broad range of routers, including those from Netgear, D-Link, Ubiquiti, Cisco, and those running DD-WRT and OpenWrt.</p> </div> <div> <p>AirSnitch “breaks worldwide Wi-Fi encryption, and it might have the potential to enable advanced cyberattacks,” Xin’an Zhou, the lead author of the research paper, said in an interview. “Advanced attacks can build on our primitives to [perform] cookie stealing, DNS and cache poisoning. Our research physically wiretaps the wire altogether so these sophisticated attacks will work. It’s really a threat to worldwide network security.” Zhou presented his research on Wednesday at the 2026 <a href="https://www.ndss-symposium.org/ndss2026/">Network and Distributed System Security Symposium</a>.</p>
<p>Paper co-author Mathy Vanhoef, <a href="https://infosec.exchange/deck/@vanhoefm/116138411163131123">said</a> a few hours after this post went live that the attack may be better described as a Wi-Fi encryption “bypass,” “in the sense that we can bypass client isolation. We don’t break Wi-Fi authentication or encryption. Crypto is often bypassed instead of broken. And we bypass it ;)” People who don’t rely on client or network isolation, he added, are safe.</p>
<p>Previous Wi-Fi attacks that overnight broke existing protections such as <a href="https://dev.to/rijultp/wep-encryption-explained-how-it-worked-and-why-it-failed-23pf">WEP</a> and <a href="https://dl.aircrack-ng.org/breakingwepandwpa.pdf">WPA</a> worked by exploiting vulnerabilities in the underlying encryption they used. AirSnitch, by contrast, targets a previously overlooked attack surface—the lowest levels of the networking stack, a hierarchy of architecture and protocols based on their functions and behaviors.</p>
<p>The lowest level, Layer-1, encompasses physical devices such as cabling, connected nodes, and all the things that allow them to communicate. The highest level, Layer-7, is where applications such as browsers, email clients, and other Internet software run. Levels 2 through 6 are known as the Data Link, Network, Transport, Session, and Presentation layers, respectively.</p>
<h2>Identity crisis</h2>
<p>Unlike previous Wi-Fi attacks, AirSnitch exploits core features in Layers 1 and 2 and the failure to bind and synchronize a client across these and higher layers, other nodes, and other network names such as SSIDs (Service Set Identifiers). This cross-layer identity desynchronization is the key driver of AirSnitch attacks.</p> </div> <div> <p>The most powerful such attack is a full, bidirectional <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">machine-in-the-middle (MitM) attack</a>, meaning the attacker can view and modify data before it makes its way to the intended recipient. The attacker can be on the same SSID, a separate one, or even a separate network segment tied to the same AP. It works against small Wi-Fi networks in both homes and offices and large networks in enterprises.</p> <p>With the ability to intercept all link-layer traffic (that is, the traffic as it passes between Layers 1 and 2), an attacker can perform other attacks on higher layers. The most dire consequence occurs when an Internet connection isn’t encrypted—something that Google <a href="https://transparencyreport.google.com/https/overview">recently estimated</a> occurred when as much as 6 percent and 20 percent of pages loaded on Windows and Linux, respectively. In these cases, the attacker can view and modify all traffic in the clear and steal authentication cookies, passwords, payment card details, and any other sensitive data. Since many company intranets are sent in plaintext, traffic from them can also be intercepted.</p>
<p>Even when HTTPS is in place, an attacker can still intercept domain look-up traffic and use DNS cache poisoning to corrupt tables stored by the target’s operating system. The AirSnitch MitM also puts the attacker in the position to wage attacks against vulnerabilities that may not be patched. Attackers can also see the external IP addresses hosting webpages being visited and often correlate them with the precise URL.</p>
<p>Given the range of possibilities it affords, AirSnitch gives attackers capabilities that haven’t been possible with other Wi-Fi attacks, including KRACK from <a href="https://arstechnica.com/information-technology/2017/10/severe-flaw-in-wpa2-protocol-leaves-wi-fi-traffic-open-to-eavesdropping/">2017</a> and <a href="https://arstechnica.com/information-technology/2019/04/serious-flaws-leave-wpa3-vulnerable-to-hacks-that-steal-wi-fi-passwords/">2019</a> and more recent Wi-Fi attacks that, like AirSnitch, inject data (known as frames) into remote <a href="https://i.blackhat.com/BH-USA-25/Presentations/USA-25-Tung-From-Spoofing-To-Tunneling-New-wp.pdf">GRE tunnels</a> and <a href="https://www.usenix.org/legacy/event/woot11/tech/final_files/Goodspeed.pdf">bypass network access control lists</a>.</p>
<p>“This work is impressive because unlike other frame injection methods, the attacker controls a bidirectional flow,” said HD Moore, a security expert and the founder and CEO of <a href="https://www.runzero.com/authors/hd-moore/">runZero</a>.</p> </div> <div> <p>He continued:</p>
<blockquote><p>This research shows that a wireless-connected attacker can subvert client isolation and implement full relay attacks against other clients, similar to old-school ARP spoofing. In a lot of ways, this restores the attack surface that was present before client isolation became common. For folks who lived through the chaos of early wireless guest networking rollouts (planes, hotels, coffee shops) this stuff should be familiar, but client isolation has become so common, these kinds of attacks may have fallen off people’s radar.</p></blockquote>
<h2>Stuck in the middle with you</h2>
<p>The MitM targets Layers 1 and 2 and the interaction between them. It starts with <a href="https://www.geeksforgeeks.org/ethical-hacking/what-is-port-stealing/">port stealing</a>, one of the earliest attack classes of Ethernet that’s adapted to work against Wi-Fi. An attacker carries it out by modifying the Layer-1 mapping that associates a network port with a victim’s <a href="https://en.wikipedia.org/wiki/MAC_address">MAC</a>—a unique address that identifies each connected device. By connecting to the <a href="https://www.differencebetween.net/technology/difference-between-bssid-and-ssid/">BSSID</a> that bridges the AP to a radio frequency the target isn’t using (usually a 2.4GHz or 5GHz) and completing a Wi-Fi <a href="https://networklessons.com/wireless/wpa-and-wpa2-4-way-handshake">four-way handshake</a>, the attacker replaces the target’s MAC with one of their own.</p>
<figure> <div> <p><a href="https://cdn.arstechnica.net/wp-content/uploads/2026/02/airsnitch-mitm-downlink.png" target="_blank" rel="noopener noreferrer"> <img src="https://cdn.arstechnica.net/wp-content/uploads/2026/02/airsnitch-mitm-downlink-640x791.png" alt=""> </a></p><div><p> The attacker spoofs the victim’s MAC address on a different NIC,<br>causing the internal switch to mistakenly associate the victim’s address with the attacker’s port/BSSID. As a result, frames intended for the victim are<br>forwarded to the attacker and encrypted using the attacker’s PTK. </p><p> Credit: Zhou et al. </p> </div> </div> <figcaption> <div> <p> The attacker spoofs the victim’s MAC address on a different NIC,<br>causing the internal switch to mistakenly associate the victim’s address with the attacker’s port/BSSID. As a result, frames intended for the victim are<br>forwarded to the attacker and encrypted using the attacker’s PTK. <span> Credit: Zhou et al. </span> </p> </div> </figcaption> </figure> <p>In other words, the attacker connects to the Wi-Fi network using the target’s MAC and then receives the target’s traffic. With this, an attacker obtains all downlink traffic (data sent from the router) intended for the target. Once the switch at Layer-2 sees the response, it updates its MAC address table to preserve the new mapping for as long as the attacker needs.</p>
<p>This completes the first half of the MitM, allowing all data to flow to the attacker. That alone would result in little more than a denial of service for the target. To prevent the target from noticing—and more importantly, to gain the bidirectional MitM capability needed to perform more advanced attacks—the attacker needs a way to restore the original mapping (the one assigning the victim’s MAC to the Layer-1 port). An attacker performs this restoration by sending an <a href="https://en.wikipedia.org/wiki/Internet_Control_Message_Protocol">ICMP ping</a> from a random MAC. The ping, which must be wrapped in a Group Temporal key shared among all clients, triggers replies that cause the Layer-1 mapping (i.e., port states) to revert back to the original one.</p> </div> <div> <p>“In a normal Layer-2 switch, the switch learns the MAC of the client by seeing it respond with its source address,” Moore explained. “This attack confuses the AP into thinking that the client reconnected elsewhere, allowing an attacker to redirect Layer-2 traffic. Unlike Ethernet switches, wireless APs can’t tie a physical port on the device to a single client; clients are mobile by design.”</p>
<p>The back-and-forth flipping of the MAC from the attacker to the target, and vice versa, can continue for as long as the attacker wants. With that, the bidirectional MitM has been achieved. Attackers can then perform a host of other attacks, both related to AirSnitch or ones such as the cache poisoning discussed earlier. Depending on the router the target is using, the attack can be performed even when the attacker and target are connected to separate SSIDs connected by the same AP. In some cases, Zhou said, the attacker can even be connected from the Internet.</p>
<p>“Even when the guest SSID has a different name and password, it may still share parts of the same internal network infrastructure as your main Wi-Fi,” the researcher explained. “In some setups, that shared infrastructure can allow unexpected connectivity between guest devices and trusted devices.”</p>
<h2>No, enterprise defenses won’t protect you</h2>
<p>Variations of the attack defeat the client isolation promised by makers of enterprise routers, which typically use credentials and a master encryption key that are unique to each client. One such attack works across multiple APs when they share a wired distribution system, as is common in enterprise and campus networks.</p>
<p>In their paper, <a href="https://www.ndss-symposium.org/ndss-paper/airsnitch-demystifying-and-breaking-client-isolation-in-wi-fi-networks/">AirSnitch: Demystifying and Breaking Client Isolation in Wi-Fi Networks</a>, the researchers wrote:</p>
<blockquote><p>Although port stealing was originally devised for hosts on the same switch, we show that attackers can hijack MAC-to-port mappings at a higher layer, i.e., at the level of the distribution switch—to intercept traffic to victims associated with different APs. This escalates the attack beyond its traditional limits, breaking the assumption that separate APs provide effective isolation.</p>
<p>This discovery exposes a blind spot in client isolation: even physically separated APs, broadcasting different SSIDs, offer ineffective isolation if connected to a common distribution system. By redirecting traffic at the distribution switch, attackers can intercept and manipulate victim traffic across AP boundaries, expanding the threat model for modern Wi-Fi networks.</p></blockquote>
<p>The researchers demonstrated that their attacks can enable the breakage of <a href="https://en.wikipedia.org/wiki/RADIUS">RADIUS</a>, a centralized authentication protocol for <a href="https://www.fortinet.com/resources/cyberglossary/radius-protocol">enhanced security</a> in enterprise networks. “By spoofing a gateway MAC and connecting to an AP,” the researchers wrote, “an attacker can steal uplink RADIUS packets.” The attacker can go on to crack a message authenticator that’s used for integrity protection and, from there, learn a shared passphrase. “This allows the attacker to set up a rogue RADIUS server and associated rogue WPA2/3 access point, which allows any legitimate client to connect, thereby intercepting their traffic and credentials.”</p> </div> <div> <p>The researchers tested the following 11 devices:</p>
<ul>
<li>Netgear Nighthawk x6 R8000</li>
<li>Tenda RX2 Pro</li>
<li>D-LINK DIR-3040</li>
<li>TP-LINK Archer AXE75</li>
<li>ASUS RT-AX57</li>
<li>DD-WRT v3.0-r44715</li>
<li>OpenWrt 24.10</li>
<li>Ubiquiti AmpliFi Alien Router</li>
<li>Ubiquiti AmpliFi Router HD</li>
<li>LANCOM LX-6500</li>
<li>Cisco Catalyst 9130</li>
</ul>
<p>As noted earlier, every tested router was vulnerable to at least one attack. Zhou said that some router makers have already released updates that mitigate some of the attacks, and more updates are expected in the future. But he also said some manufacturers have told him that some of the systemic weaknesses can only be addressed through changes in the underlying chips they buy from silicon makers.</p>
<p>The hardware manufacturers face yet another challenge: The client isolation mechanisms vary from maker to maker. With no industry-wide standard, these one-off solutions are splintered and may not receive the concerted security attention that formal protocols are given.</p> <h2>So how bad is AirSnitch, really?</h2>
<p>With a basic understanding of AirSnitch, the next step is to put it into historical context and assess how big a threat it poses in the real world. In some respects, it resembles the 2007 <a href="https://eprint.iacr.org/2007/120.pdf">PTW attack</a> (named for its creators Andrei Pyshkin, Erik Tews, and Ralf-Philipp Weinmann) that completely and immediately broke WEP, leaving Wi-Fi users everywhere with no means to protect themselves against nearby adversaries. For now, client isolation is similarly defeated—almost completely and overnight—with no immediate remedy available.</p>
<p>At the same time, the bar for waging WEP attacks was significantly lower, since it was available to anyone within range of an AP. AirSnitch, by contrast, requires that the attacker already have some sort of access to the Wi-Fi network. For many people, that may mean steering clear of public Wi-Fi networks altogether.</p>
<p>If the network is properly secured—meaning it’s protected by a strong password that’s known only to authorized users—AirSnitch may not be of much value to an attacker. The nuance here is that even if an attacker doesn’t have access to a specific SSID, they may still use AirSnitch if they have access to other SSIDs or BSSIDs that use the same AP or other connecting infrastructure.</p> </div> <div> <p>Yet another difference to the PTW attack—and others that have followed breaking WPA, WPA2, and WPA3 protections—is that they were limited to hacks using terrestrial radio signals, a much more limited theater than the one AirSnitch uses. Ultimately, the AirSnitch attacks are broader but less severe.</p>
<p>Also unlike those previous attacks, firewall mitigations may be more problematic.</p>
<p>“We expand the threat model showing an attacker can be on another channel or port, or can be from the Internet,” Zhou said. “Firewalls are also networking devices. We often say a firewall is a Layer-3 device because it works at the IP layer. But fundamentally, it’s connected by wire to different network elements. That wire is not secure.”</p>
<p>Some of the threat can be mitigated by using VPNs, but this remedy has all the usual drawbacks that come with them. For one, VPNs are notorious for leaking metadata, DNS queries, and other traffic that can be useful to attackers, making the protection limited. And for another, finding a reputable and trustworthy VPN provider has historically proven to be <a href="https://arstechnica.com/information-technology/2016/06/aiming-for-anonymity-ars-assesses-the-state-of-vpns-in-2016/">vexingly difficult</a>, though things have <a href="https://www.nytimes.com/wirecutter/reviews/best-vpn-service/">improved</a> more recently. Ultimately, a VPN shouldn’t be regarded as much more than a bandage.</p>
<p>Another potential mitigation is using wireless <a href="https://en.wikipedia.org/wiki/VLAN">VLANs</a> to isolate one SSID from another. Zhou said such options aren’t universally available and are also “super easy to be configured wrong.” Specifically, he said VLANs can often be implemented in ways that allow “hopping vulnerabilities.” Further, Moore <a href="https://arstechnica.com/civis/posts/44274656/">has argued</a> why “VLANs are not a practical barrier” against all AirSnitch attacks</p>
<p>The most effective remedy may be to adopt a security stance known as <a href="https://www.wired.com/story/what-is-zero-trust/">zero trust</a>, which treats each node inside a network as a potential adversary until it provides proof it can be trusted. This model is challenging for even well-funded enterprise organizations to adopt, although it’s becoming easier. It’s not clear if it will ever be feasible for more casual Wi-Fi users in homes and smaller businesses.</p> </div> <div> <div> <p>Probably the most reasonable response is to exercise measured caution for all Wi-Fi networks managed by people you don’t know. When feasible, use a trustworthy VPN on public APs or, better yet, tether a connection from a cell phone.</p>
<p>Wi-Fi has always been a risky proposition, and AirSnitch only expands the potential for malice. Then again, the new capabilities may mean little in the real world, where <a href="https://en.wikipedia.org/wiki/Evil_twin_(wireless_networks)">evil twin</a> attacks accomplish many of the same objectives with much less hassle.</p>
<p>Moore said the attacks possible before client isolation were often as simple as running <a href="https://www.ettercap-project.org/">ettercap</a> or similar tools as soon as a normal Wi-Fi connection was completed. AirSnitch attacks require considerably more work, at least until someone writes an easy-to-use script that automates it.</p>
<p>“It will be interesting to see if the wireless vendors care enough to resolve these issues completely and if attackers care enough to put all of this together when there might be easier things to do (like run a fake AP instead),” Moore said. “At the least it should make pentesters’ lives more interesting since it re-opens a lot of exposure that many folks may not have any experience with.”</p>
<p><em>Headline updated to change “breaks” with “bypasses.”</em></p> </div> <div> <div> <p><a href="https://arstechnica.com/author/dan-goodin/"><img src="https://cdn.arstechnica.net/wp-content/uploads/2018/10/Dang.jpg" alt="Photo of Dan Goodin"></a></p> </div> <div> <p> Dan Goodin is Senior Security Editor at Ars Technica, where he oversees coverage of malware, computer espionage, botnets, hardware hacking, encryption, and passwords. In his spare time, he enjoys gardening, cooking, and following the independent music scene. Dan is based in San Francisco. Follow him at <a href="https://infosec.exchange/@dangoodin">here</a> on Mastodon and <a href="https://bsky.app/profile/dangoodin.bsky.social">here</a> on Bluesky. Contact him on Signal at DanArs.82. </p> </div>
</div> <p> <a href="https://arstechnica.com/security/2026/02/new-airsnitch-attack-breaks-wi-fi-encryption-in-homes-offices-and-enterprises/#comments"> 139 Comments </a> </p> </div> </article> <div> <header> </header> <ol> <li> <a href="https://arstechnica.com/security/2026/02/new-airsnitch-attack-breaks-wi-fi-encryption-in-homes-offices-and-enterprises/"> <img src="https://cdn.arstechnica.net/wp-content/uploads/2025/06/wi-fi-768x432-1751309981.jpg" alt="Listing image for first story in Most Read: New AirSnitch attack bypasses Wi-Fi encryption in homes, offices, and enterprises"> </a> </li> <li> </li> <li> </li> <li> </li> <li> </li> </ol>
</div> </div></div>
  </div>
  <div class="article-elevator" aria-label="Navigation article">
    <button class="article-elevator-btn" type="button" onclick="scrollToTop()">▲</button>
    <button class="article-elevator-btn" type="button" onclick="scrollToBottom()">▼</button>
  </div>
  <script>
    function stripBlockingPanels() {
      const selector = '[id*="overlay"], [class*="overlay"], [id*="modal"], [class*="modal"], [id*="popup"], [class*="popup"], [id*="paywall"], [class*="paywall"], [id*="subscribe"], [class*="subscribe"], [id*="cookie"], [class*="cookie"], [id*="consent"], [class*="consent"], [id*="gdpr"], [class*="gdpr"], [role="dialog"], [aria-modal="true"]';
      const textPattern = /\b(cookie|consent|gdpr|subscribe|subscription|paywall|abonnez[-\s]?vous|inscrivez[-\s]?vous|continue reading|continuez la lecture)\b/i;
      document.querySelectorAll(selector).forEach((node) => node.remove());
      document.querySelectorAll('div, section, aside').forEach((node) => {
        const styleAttr = String(node.getAttribute('style') || '').toLowerCase();
        const classAndId = String(node.className || '').toLowerCase() + ' ' + String(node.id || '').toLowerCase();
        const text = String(node.textContent || '').slice(0, 800);
        const hasKeyword = textPattern.test(classAndId) || textPattern.test(text);
        const looksFixed = /(position\s*:\s*(fixed|sticky)|inset\s*:|top\s*:|left\s*:|right\s*:|bottom\s*:)/.test(styleAttr);
        const hasPriority = /(z-index\s*:\s*[1-9]\d{1,}|backdrop-filter|overflow\s*:\s*hidden)/.test(styleAttr);
        if (hasKeyword && (looksFixed || hasPriority)) node.remove();
      });
    }
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'auto' });
    }
    function scrollToBottom() {
      window.scrollTo({ top: document.documentElement.scrollHeight, behavior: 'auto' });
    }
    window.addEventListener('message', (event) => {
      const data = event && event.data;
      if (!data || data.type !== 'AI_PULSE_SCROLL') return;
      if (data.direction === 'up' || data.direction === 'top') scrollToTop();
      if (data.direction === 'down' || data.direction === 'bottom') scrollToBottom();
    });
    stripBlockingPanels();
    setTimeout(stripBlockingPanels, 60);
    setTimeout(stripBlockingPanels, 220);
    setTimeout(stripBlockingPanels, 650);
  </script>
</body>
</html>