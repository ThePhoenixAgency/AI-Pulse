<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GitHub - IamLumae/DirectShell: Because i could not Ressist</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; line-height: 1.55; color: #e2e8f0; max-width: 800px; margin: 26px auto; padding: 0 18px; background: #0a0e27; }
  h1 { color: #00d9ff; margin-bottom: 0.35em; line-height: 1.22; font-size: clamp(1.45rem, 2.1vw, 1.95rem); font-weight: 700; }
  h2, h3 { line-height: 1.28; margin: 1.1em 0 0.45em; }
  .metadata { color: #94a3b8; font-size: 0.86em; margin-bottom: 1.2em; border-bottom: 1px solid rgba(0,217,255,0.2); padding-bottom: 0.7em; }
  img { max-width: 100%; width: auto !important; height: auto !important; object-fit: contain !important; border-radius: 8px; display: block; margin: 0.6em auto; }
  a { color: #00d9ff; }
  p { margin-bottom: 0.72em; line-height: 1.58; }
  ul, ol { margin: 0.5em 0 0.9em 1.1em; }
  li { margin: 0.18em 0; }
  blockquote { border-left: 3px solid #825ee4; padding-left: 12px; margin: 0.8em 0; color: #94a3b8; }
  code { background: rgba(0,0,0,0.3); padding: 2px 6px; border-radius: 3px; color: #ff79c6; }
  pre { background: rgba(0,0,0,0.4); padding: 12px; border-radius: 6px; overflow-x: auto; }
  .article-elevator { position: fixed; right: 14px; bottom: 14px; display: flex; flex-direction: column; gap: 8px; z-index: 9999; }
  .article-elevator-btn { width: 36px; height: 36px; border: 1px solid rgba(0,217,255,0.35); border-radius: 10px; background: rgba(10,14,39,0.88); color: #00d9ff; cursor: pointer; font-size: 16px; line-height: 1; }
  .article-elevator-btn:hover { background: rgba(10,14,39,1); }
  [id*="overlay"], [class*="overlay"], [id*="modal"], [class*="modal"], [id*="popup"], [class*="popup"],
  [id*="paywall"], [class*="paywall"], [id*="subscribe"], [class*="subscribe"], [id*="cookie"], [class*="cookie"],
  [id*="consent"], [class*="consent"], [id*="gdpr"], [class*="gdpr"], [role="dialog"], [aria-modal="true"] {
    display: none !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }
</style>
</head>
<body>
  <h1>GitHub - IamLumae/DirectShell: Because i could not Ressist</h1>
  <div class="metadata">
    Source: Hacker News Show | Date: 2/17/2026 6:57:45 PM | <a href="https://github.com/IamLumae/DirectShell" target="_blank" rel="noopener noreferrer">Lien</a> | Lang: EN
  </div>
  <div class="content">
    <p> <a target="_blank" href="/IamLumae/DirectShell/blob/main/assets/banner.png"><img src="/IamLumae/DirectShell/raw/main/assets/banner.png" alt="DirectShell"></a>
</p>
<p><strong>Universal Application Control Through the Accessibility Layer</strong></p>
<p><em><strong>As of February 17, 2026, every screenshot-based AI agent, every enterprise API wrapper, and every RPA tool on Earth is legacy technology.</strong></em></p>
<p> <a href="https://youtu.be/nvZobyt0KBg">Watch the Demo</a> · <a href="/IamLumae/DirectShell/blob/main/LLM_GUIDE.md">LLM Quick Start Guide</a> · <a href="/IamLumae/DirectShell/blob/main/Dokumentation/DEVTO_ARTICLE.pdf">Read the Full Article</a> · <a href="/IamLumae/DirectShell/blob/main/Dokumentation/2026-02-16_Genesis_Session.txt">Read the Genesis Session</a>
</p>
<hr>
<blockquote>
<p><em>"You've essentially found the 'God Mode' of human-computer interaction by looking exactly where everyone else stopped looking."</em>
— Google Gemini, upon analyzing DirectShell through DirectShell itself</p>
</blockquote>
<hr>
<blockquote>
<p><em>Listen. DirectShell is not perfect. It's Day 1. Literally. There are bugs. There are errors. A hundred things that need to get better. But none of that matters. The first browser couldn't render 90% of web pages correctly. The first lightbulb flickered. Every foundational technology begins empty and broken — because the point was never whether it works perfectly now. The point is what it will make possible tomorrow.</em></p>
<p><em>The moment a community builds a profile repository — configs for every program on Earth — AI will natively operate every desktop application faster, more efficiently, and more productively than any human ever could. Not in ten years. Not after the next funding round. The infrastructure is here. Today. In 700 kilobytes.</em></p>
<p><em>Google. Microsoft. OpenAI. Anthropic. Call me. Let's talk. Let's revolutionize the world of AI in one stroke.</em></p>
<p><em>Peace at last.</em></p>
<p><em>And now I'm going to sleep for 12 hours.</em></p>
<p>— Martin Gehrken, February 17, 2026</p>
</blockquote>
<hr>
<div><h2>It's Not an App. It's Not a Product. It's a New Category.</h2><a href="#its-not-an-app-its-not-a-product-its-a-new-category"></a></div>
<p>Just as there was no way to control the internals of Windows via text commands before PowerShell, there was no way to read and control the surface of every program via text before DirectShell.</p>
<p><strong>PowerShell opened the backend. DirectShell opens the frontend.</strong></p>
<p>For humans. For AI. For everything.</p>
<hr>
<div><h2>The Problem: Everyone Is Looking at Pixels</h2><a href="#the-problem-everyone-is-looking-at-pixels"></a></div>
<p>Google, OpenAI, and Anthropic — the three largest AI companies on Earth — are all trying the same thing: making AI operate programs. Open Outlook, book invoices, fill forms. Like an employee sitting at a computer.</p>
<p>And all three do it the same way: they take a screenshot, send the screenshot to the AI, and the AI tries to <strong>guess</strong> where to click. Like explaining to someone over the phone where to click — except they only see the screen as a blurry photo.</p>
<p>It's expensive. It's slow. It's unreliable. And it breaks the moment someone changes their font size.</p>
<div><pre><code>Screenshot → Vision Model → Coordinate Guess → Simulated Click → Repeat
</code></pre></div>
<p>Anthropic Computer Use. OpenAI Operator. Google Project Mariner. Hundreds of billions of dollars in R&amp;D, and the state of the art in 2026 is <strong>taking photos of screens and guessing where to click</strong>.</p>
<div><h2>The Solution: The Door That Was Always Open</h2><a href="#the-solution-the-door-that-was-always-open"></a></div>
<p>Windows has had a built-in feature for 25 years that was developed for blind people. Every button, every text field, every menu bar in EVERY program describes itself — as text. <em>"I am the Save button. I am active. I am at position X."</em> This was built for screen readers — programs that read the screen aloud for blind users.</p>
<p>Nobody thought to use this for AI. Until now.</p>
<p>DirectShell is a transparent overlay that snaps onto any application and reads this self-description. Not as a photo. As text. And stores everything in a database that is instantly searchable.</p>
<p>Instead of: <em>"Here's a photo, guess where the Save button is"</em></p>
<p>DirectShell says: <em>"There are 47 buttons. Number 12 is called Save. It is active. It is here."</em></p>
<p>Like someone looking at your screen — only a thousand times faster and structured.</p>
<p><strong>Like Google for your screen.</strong></p>
<hr>
<div><h2>What DirectShell Can Do — and Why It Changes Everything</h2><a href="#what-directshell-can-do--and-why-it-changes-everything"></a></div>
<p><strong>It can read EVERY program.</strong> Regardless which one. SAP, Datev, Excel, every 20-year-old industry software, every app on your computer. No API needed. No permission from the manufacturer. No terms of service stand in the way — because DirectShell doesn't touch the software. It only reads what Windows already provides.</p>
<p><strong>Every AI, every script, every program can use it.</strong> Not just ChatGPT or Claude. EVERY program that can read text can now understand and control any app in the world. This opens a door that was previously closed.</p>
<p><strong>It can modify inputs live.</strong> DirectShell sits between you and the program. It can see what you type, change it, add to it, or filter it — before it reaches the program. Like an intelligent assistant that reads along in real-time and intervenes when needed.</p>
<p><strong>AI can work in real-time — without garbage in its head.</strong> This is the technical breakthrough: when an AI wants to operate a program today, it has to load thousands of image data points. That clogs its memory. With DirectShell, the AI simply asks: <em>"What buttons exist?"</em> and gets a short text answer. No photo. No data junk. The AI stays clear-headed and can focus on the actual task.</p>
<p><strong>The database makes it interactive.</strong> Instead of a program or an AI having to dig through data for minutes, it asks a targeted question to the database and gets the answer in milliseconds.</p>
<hr>
<div><h2>The Universal Interface Nobody Used</h2><a href="#the-universal-interface-nobody-used"></a></div>
<p>Today, software companies earn billions selling you access to your own data. You use SAP? Want another program to access your SAP data? Then you need the SAP API. That costs extra. You use Salesforce? Access to your own customer data from outside? Costs per user per month. Every piece of software has its own interface with its own rules and its own prices.</p>
<p>DirectShell makes that unnecessary. Every program that has a window — and that's all of them — automatically gets the same universal interface through DirectShell. Free. Without the manufacturer's permission. Not a hundred different connections that all work differently. <strong>One. For everything.</strong></p>
<p>That's like every room in a house needing its own lock with its own key — and someone invents a master key that fits every door. Not by picking the locks. But because every door had a second handle the entire time that nobody used.</p>
<hr>
<div><h2>Demo</h2><a href="#demo"></a></div>
<p><a href="https://youtu.be/nvZobyt0KBg"><img src="https://camo.githubusercontent.com/3b96e5e9e6db2307bf9adfa714a1a430617f540f6e3b34fcc4678f9260437b4d/68747470733a2f2f696d672e796f75747562652e636f6d2f76692f6e765a6f627974304b42672f6d617872657364656661756c742e6a7067" alt="DirectShell Demo"></a></p>
<p>On February 17, 2026, DirectShell demonstrated three paradigms in 5 minutes:</p>
<table>
<thead>
<tr>
<th>Paradigm</th>
<th>Application</th>
<th>What Happened</th>
<th>Time</th>
</tr>
</thead>
<tbody>
<tr>
<td>Instant Text Injection</td>
<td>Notepad</td>
<td>Multi-paragraph text written via ValuePattern</td>
<td>0 ms</td>
</tr>
<tr>
<td>Cross-Application Chat</td>
<td>Claude.ai (Haiku)</td>
<td>Full conversation read + reply typed</td>
<td>1 read</td>
</tr>
<tr>
<td>Complex Data Entry</td>
<td>Google Sheets</td>
<td>30x12 table (360 cells) with MITRE ATT&amp;CK data</td>
<td>~90 sec</td>
</tr>
</tbody>
</table>
<p>No screenshots were taken. Everything went through structured text.</p>
<hr>
<div><h2>Architecture</h2><a href="#architecture"></a></div>
<p>DirectShell is three subsystems in a single ~1.2 MB Rust binary:</p>
<div><pre><code>┌──────────────────────────────────────────────────┐
│ LLM / AI Agent │ Text in, text out
├──────────────────────────────────────────────────┤
│ DirectShell │ THIS LAYER
│ ┌─────────────┬──────────────┬────────────────┐ │
│ │ Overlay │ Input │ Feedback │ │
│ │ Manager │ Pipeline │ Reader │ │
│ │ (Snap) │ (Hooks) │ (UIA→SQLite) │ │
│ └─────────────┴──────────────┴────────────────┘ │
├──────────────────────────────────────────────────┤
│ Windows OS (Win32 API) │
├──────────────────────────────────────────────────┤
│ Target Application │ Any program. Any age.
└──────────────────────────────────────────────────┘
</code></pre></div>
<p><strong>1. Overlay Manager</strong> — A transparent, click-through window that snaps onto any application. Tracks position, size, minimize, and close at 60fps. The target app doesn't know it's there.</p>
<p><strong>2. Input Pipeline</strong> — Intercepts keyboard and mouse events via low-level hooks (</p><pre><code>SetWindowsHookEx</code></pre>). Can pass through, modify, suppress, or inject input. Uses <pre><code>SendInput</code></pre> — the OS itself vouches for the events as legitimate hardware input.<p></p>
<p><strong>3. Feedback Reader</strong> — Walks the UI Automation tree every 500ms and writes every element into SQLite (WAL mode). Produces two files:</p>
<ul>
<li><pre><code>.a11y</code></pre> database — Full element tree (name, role, value, position, enabled state, parent/child)</li>
<li><pre><code>.snap</code></pre> file — Compact operable element list for quick reads</li>
</ul>
<p>Any external process can query the database concurrently. The database IS the API:</p>
<div><pre><span><span>--</span> What buttons exist?</span>
<span>SELECT</span> name <span>FROM</span> elements <span>WHERE</span> role<span>=</span><span><span>'</span>Button<span>'</span></span> <span>AND</span> enabled<span>=</span><span>1</span> <span><span>--</span> What's in the text fields?</span>
<span>SELECT</span> name, value <span>FROM</span> elements <span>WHERE</span> role<span>=</span><span><span>'</span>Edit<span>'</span></span> <span><span>--</span> Search by content</span>
<span>SELECT</span> name <span>FROM</span> elements <span>WHERE</span> name <span>LIKE</span> <span><span>'</span>%invoice%<span>'</span></span></pre></div>
<p>Actions go through the same database:</p>
<div><pre><span>INSERT INTO</span> inject (action, <span>text</span>, target) <span>VALUES</span> (<span><span>'</span>text<span>'</span></span>, <span><span>'</span>2599.00<span>'</span></span>, <span><span>'</span>Amount<span>'</span></span>);
<span>INSERT INTO</span> inject (action, target) <span>VALUES</span> (<span><span>'</span>click<span>'</span></span>, <span><span>'</span>Save<span>'</span></span>);
<span>INSERT INTO</span> inject (action, <span>text</span>) <span>VALUES</span> (<span><span>'</span>key<span>'</span></span>, <span><span>'</span>ctrl+s<span>'</span></span>);</pre></div>
<hr>
<div><h2>Quick Start</h2><a href="#quick-start"></a></div>
<div><h3>Build</h3><a href="#build"></a></div>
<div><pre><span><span>#</span> Prerequisites: Rust toolchain (https://rustup.rs)</span>
git clone https://github.com/IamLumae/DirectShell.git
<span>cd</span> DirectShell
cargo build --release</pre></div>
<div><h3>Run</h3><a href="#run"></a></div>
<div><pre>./target/release/directshell.exe</pre></div>
<p>A small transparent window appears. Drag it over any application to snap. The Accessibility Tree is now being written to the database at 2 Hz.</p>
<div><h3>Query</h3><a href="#query"></a></div>
<div><pre>sqlite3 directshell.db <span><span>"</span>SELECT name, role, value FROM elements WHERE role='Edit'<span>"</span></span></pre></div>
<div><h3>Inject</h3><a href="#inject"></a></div>
<div><pre>sqlite3 directshell.db <span><span>"</span>INSERT INTO inject (action, text, target) VALUES ('text', 'Hello', 'Search Box')<span>"</span></span></pre></div>
<hr>
<div><h2>The MCP Server — First Program Built on DirectShell</h2><a href="#the-mcp-server--first-program-built-on-directshell"></a></div>
<p>The </p><pre><code>ds-mcp/</code></pre> directory contains a <strong>Model Context Protocol server</strong> — the first program built on top of DirectShell. It is not part of DirectShell itself. DirectShell is the primitive; the MCP server is a tool that demonstrates what you can build on it.<p></p>
<p>The MCP server exposes DirectShell's capabilities as structured tool calls that any MCP-compatible LLM can invoke:</p>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><pre><code>ds_status</code></pre></td>
<td>Check what app is snapped</td>
</tr>
<tr>
<td><pre><code>ds_state</code></pre></td>
<td>Read all operable elements</td>
</tr>
<tr>
<td><pre><code>ds_screen</code></pre></td>
<td>Full screen reader view</td>
</tr>
<tr>
<td><pre><code>ds_query</code></pre></td>
<td>Run SQL against the element database</td>
</tr>
<tr>
<td><pre><code>ds_click</code></pre> / <pre><code>ds_text</code></pre> / <pre><code>ds_type</code></pre> / <pre><code>ds_key</code></pre></td>
<td>Control the application</td>
</tr>
<tr>
<td><pre><code>ds_batch</code></pre></td>
<td>Execute multiple actions in sequence</td>
</tr>
<tr>
<td><pre><code>ds_find</code></pre></td>
<td>Search elements by name pattern</td>
</tr>
<tr>
<td><pre><code>ds_events</code></pre></td>
<td>Get live UI change events (delta perception)</td>
</tr>
<tr>
<td><pre><code>ds_scroll</code></pre></td>
<td>Scroll in any direction</td>
</tr>
</tbody>
</table>
<div><h3>MCP Configuration</h3><a href="#mcp-configuration"></a></div>
<div><pre>{ <span>"mcpServers"</span>: { <span>"directshell"</span>: { <span>"command"</span>: <span><span>"</span>python<span>"</span></span>, <span>"args"</span>: [<span><span>"</span>ds-mcp/server.py<span>"</span></span>], <span>"cwd"</span>: <span><span>"</span>/path/to/DirectShell<span>"</span></span> } }
}</pre></div>
<p>With this, any LLM using MCP can read and control any Windows application through natural language.</p>
<hr>
<div><h2>What DirectShell Is (and What It Isn't)</h2><a href="#what-directshell-is-and-what-it-isnt"></a></div>
<table>
<thead>
<tr>
<th>What It Is</th>
<th>What It Isn't</th>
</tr>
</thead>
<tbody>
<tr>
<td>A primitive — a foundational building block</td>
<td>A finished product</td>
</tr>
<tr>
<td>Infrastructure, like PowerShell or the browser</td>
<td>An application you install and use</td>
</tr>
<tr>
<td>Universal — works on ANY Windows app</td>
<td>Limited to specific frameworks</td>
</tr>
<tr>
<td>A new category of software</td>
<td>Just another automation tool</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Primitive</th>
<th>Domain</th>
<th>What It Universalizes</th>
</tr>
</thead>
<tbody>
<tr>
<td>PowerShell</td>
<td>Backend automation</td>
<td>CLI access to OS services</td>
</tr>
<tr>
<td>Browser</td>
<td>Information access</td>
<td>HTTP/HTML for any web resource</td>
</tr>
<tr>
<td>SQL</td>
<td>Data access</td>
<td>Query language for any database</td>
</tr>
<tr>
<td><strong>DirectShell</strong></td>
<td><strong>Frontend automation</strong></td>
<td><strong>Input/output for any GUI application</strong></td>
</tr>
</tbody>
</table>
<hr>
<div><h2>Security Implications</h2><a href="#security-implications"></a></div>
<p><strong>This section exists because honesty matters more than marketing.</strong></p>
<p>DirectShell uses the Windows Accessibility Layer — an interface that has existed since 1997, is legally mandated by disability law in 186 countries, and cannot be disabled without simultaneously locking blind users out of their computers.</p>
<p>This means:</p>
<ul>
<li>Any process at user level can read every UI element of every application on the system</li>
<li>Any process can inject input indistinguishable from human hardware events</li>
<li>This is not a vulnerability. This is how the operating system works. By design.</li>
</ul> <p>DirectShell does not bypass access controls. It does not inject code into other processes. It does not call undocumented APIs. It uses the interfaces that Microsoft built, documented, and legally cannot remove.</p>
<p><strong>The user is operating their software. How they press their keys is their own business.</strong></p>
<hr>
<div><h2>Technical Stack</h2><a href="#technical-stack"></a></div>
<table>
<thead>
<tr>
<th>Component</th>
<th>Technology</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td>Language</td>
<td>Rust</td>
<td>Zero-cost abstractions, single binary, safe Win32 FFI</td>
</tr>
<tr>
<td>Win32 bindings</td>
<td><pre><code>windows</code></pre> crate v0.58</td>
<td>Official Microsoft Rust bindings</td>
</tr>
<tr>
<td>UI Automation</td>
<td>COM via <pre><code>IUIAutomation</code></pre></td>
<td>Windows' built-in accessibility framework</td>
</tr>
<tr>
<td>Input hooks</td>
<td><pre><code>SetWindowsHookEx</code></pre></td>
<td>System-wide keyboard/mouse interception</td>
</tr>
<tr>
<td>Database</td>
<td><pre><code>rusqlite</code></pre> (SQLite, bundled)</td>
<td>Embedded, WAL-mode, zero-config</td>
</tr>
<tr>
<td>Binary size</td>
<td>~1.2 MB</td>
<td>Including bundled SQLite</td>
</tr>
</tbody>
</table>
<hr>
<div><h2>Documentation</h2><a href="#documentation"></a></div>
<ul>
<li><a href="/IamLumae/DirectShell/blob/main/ARCHITECTURE.md"><pre><code>ARCHITECTURE.md</code></pre></a> — High-level architecture and rationale</li>
<li><a href="/IamLumae/DirectShell/blob/main/BRAINSTORM.md"><pre><code>BRAINSTORM.md</code></pre></a> — Original vision and design decisions</li>
<li><a href="/IamLumae/DirectShell/blob/main/Dokumentation/ARCHITECTURE.md"><pre><code>Dokumentation/ARCHITECTURE.md</code></pre></a> — Technical reference (code-level)</li>
<li><a href="/IamLumae/DirectShell/blob/main/Dokumentation/PAPER.md"><pre><code>Dokumentation/PAPER.md</code></pre></a> — Academic whitepaper</li>
<li><a href="/IamLumae/DirectShell/blob/main/Dokumentation/DEVTO_ARTICLE.pdf"><pre><code>Dokumentation/DEVTO_ARTICLE.pdf</code></pre></a> — Full article (PDF)</li>
<li><a href="/IamLumae/DirectShell/blob/main/Dokumentation/2026-02-16_Genesis_Session.txt"><pre><code>Dokumentation/2026-02-16_Genesis_Session.txt</code></pre></a> — The complete build session: 8.5 hours from idea to working prototype</li>
</ul>
<hr>
<div><h2>License</h2><a href="#license"></a></div>
<p><strong>GNU Affero General Public License v3.0 or later</strong> (AGPL-3.0-or-later)</p>
<p>You can use, modify, and distribute DirectShell freely. If you modify it and deploy it as a network service, you must share your source code. See <a href="/IamLumae/DirectShell/blob/main/LICENSE">LICENSE</a> for the full text.</p>
<hr>
<div><h2>Author</h2><a href="#author"></a></div>
<p><strong>Martin Gehrken</strong> (<a href="https://github.com/IamLumae">@IamLumae</a>)</p>
<p>Solo developer. No company. No funding. No IT degree.</p>
<p>The Accessibility Tree has been there for 25 years. Everyone was looking at pixels.</p>
<p>I looked at the tree.</p>
  </div>
  <div class="article-elevator" aria-label="Navigation article">
    <button class="article-elevator-btn" type="button" onclick="scrollToTop()">▲</button>
    <button class="article-elevator-btn" type="button" onclick="scrollToBottom()">▼</button>
  </div>
  <script>
    function stripBlockingPanels() {
      const selector = '[id*="overlay"], [class*="overlay"], [id*="modal"], [class*="modal"], [id*="popup"], [class*="popup"], [id*="paywall"], [class*="paywall"], [id*="subscribe"], [class*="subscribe"], [id*="cookie"], [class*="cookie"], [id*="consent"], [class*="consent"], [id*="gdpr"], [class*="gdpr"], [role="dialog"], [aria-modal="true"]';
      const textPattern = /\b(cookie|consent|gdpr|subscribe|subscription|paywall|abonnez[-\s]?vous|inscrivez[-\s]?vous|continue reading|continuez la lecture)\b/i;
      document.querySelectorAll(selector).forEach((node) => node.remove());
      document.querySelectorAll('div, section, aside').forEach((node) => {
        const styleAttr = String(node.getAttribute('style') || '').toLowerCase();
        const classAndId = String(node.className || '').toLowerCase() + ' ' + String(node.id || '').toLowerCase();
        const text = String(node.textContent || '').slice(0, 800);
        const hasKeyword = textPattern.test(classAndId) || textPattern.test(text);
        const looksFixed = /(position\s*:\s*(fixed|sticky)|inset\s*:|top\s*:|left\s*:|right\s*:|bottom\s*:)/.test(styleAttr);
        const hasPriority = /(z-index\s*:\s*[1-9]\d{1,}|backdrop-filter|overflow\s*:\s*hidden)/.test(styleAttr);
        if (hasKeyword && (looksFixed || hasPriority)) node.remove();
      });
    }
    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'auto' });
    }
    function scrollToBottom() {
      window.scrollTo({ top: document.documentElement.scrollHeight, behavior: 'auto' });
    }
    window.addEventListener('message', (event) => {
      const data = event && event.data;
      if (!data || data.type !== 'AI_PULSE_SCROLL') return;
      if (data.direction === 'up' || data.direction === 'top') scrollToTop();
      if (data.direction === 'down' || data.direction === 'bottom') scrollToBottom();
    });
    stripBlockingPanels();
    setTimeout(stripBlockingPanels, 60);
    setTimeout(stripBlockingPanels, 220);
    setTimeout(stripBlockingPanels, 650);
  </script>
</body>
</html>